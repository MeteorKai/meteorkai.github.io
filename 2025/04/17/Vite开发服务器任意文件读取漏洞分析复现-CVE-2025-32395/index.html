<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="第四个CVE了。。这是TGCTF的时候给我遇到的，再来复现！ 我们先来看看影响版本：  &gt;&#x3D;6.2.0, &lt;&#x3D;6.2.5 &gt;&#x3D;6.1.0, &lt;&#x3D;6.1.4 &gt;&#x3D;6.0.0, &lt;&#x3D;6.0.14 &gt;&#x3D;5.0.0, &lt;&#x3D;5.4.17 &lt;&#x3D;4.5.12  前几天的">
<meta property="og:type" content="article">
<meta property="og:title" content="Vite开发服务器任意文件读取漏洞分析复现(CVE-2025-32395)">
<meta property="og:url" content="http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/index.html">
<meta property="og:site_name" content="Meteor_Kai">
<meta property="og:description" content="第四个CVE了。。这是TGCTF的时候给我遇到的，再来复现！ 我们先来看看影响版本：  &gt;&#x3D;6.2.0, &lt;&#x3D;6.2.5 &gt;&#x3D;6.1.0, &lt;&#x3D;6.1.4 &gt;&#x3D;6.0.0, &lt;&#x3D;6.0.14 &gt;&#x3D;5.0.0, &lt;&#x3D;5.4.17 &lt;&#x3D;4.5.12  前几天的">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/image-20250414135209030.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/image-20250414140931338.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/image-20250414141112003.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/image-20250417124308498.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/image-20250417124316812.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/image-20250417125209196.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/image-20250417141050661.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/image-20250417141751949.png">
<meta property="article:published_time" content="2025-04-17T06:34:57.000Z">
<meta property="article:modified_time" content="2025-04-17T06:38:03.513Z">
<meta property="article:author" content="Meteor_Kai">
<meta property="article:tag" content="CVE复现">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/image-20250414135209030.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Vite开发服务器任意文件读取漏洞分析复现(CVE-2025-32395)</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About me</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/MeteorKai/">Projects</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/categories/">categories</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     --><!--
       --><li><a href="/links/">links</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2025/04/28/2025%E5%B9%B3%E8%88%AA%E6%9D%AF-wp/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2025/04/10/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-31486/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/&text=Vite开发服务器任意文件读取漏洞分析复现(CVE-2025-32395)"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/&title=Vite开发服务器任意文件读取漏洞分析复现(CVE-2025-32395)"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/&is_video=false&description=Vite开发服务器任意文件读取漏洞分析复现(CVE-2025-32395)"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Vite开发服务器任意文件读取漏洞分析复现(CVE-2025-32395)&body=Check out this article: http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/&title=Vite开发服务器任意文件读取漏洞分析复现(CVE-2025-32395)"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/&title=Vite开发服务器任意文件读取漏洞分析复现(CVE-2025-32395)"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/&title=Vite开发服务器任意文件读取漏洞分析复现(CVE-2025-32395)"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/&title=Vite开发服务器任意文件读取漏洞分析复现(CVE-2025-32395)"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/&name=Vite开发服务器任意文件读取漏洞分析复现(CVE-2025-32395)&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/&t=Vite开发服务器任意文件读取漏洞分析复现(CVE-2025-32395)"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-number">1.</span> <span class="toc-text">环境搭建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%AE%A1%E8%AE%A1"><span class="toc-number">2.</span> <span class="toc-text">源码审计</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E4%BF%AE%E8%A1%A5"><span class="toc-number">3.</span> <span class="toc-text">漏洞修补</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        Vite开发服务器任意文件读取漏洞分析复现(CVE-2025-32395)
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Meteor_Kai</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-04-17T06:34:57.000Z" class="dt-published" itemprop="datePublished">2025-04-17</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/CVE%E5%A4%8D%E7%8E%B0/">CVE复现</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/CVE%E5%A4%8D%E7%8E%B0/" rel="tag">CVE复现</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p>第四个CVE了。。这是TGCTF的时候给我遇到的，再来复现！</p>
<p>我们先来看看影响版本：</p>
<blockquote>
<p>&gt;&#x3D;6.2.0, &lt;&#x3D;6.2.5</p>
<p>&gt;&#x3D;6.1.0, &lt;&#x3D;6.1.4</p>
<p>&gt;&#x3D;6.0.0, &lt;&#x3D;6.0.14</p>
<p>&gt;&#x3D;5.0.0, &lt;&#x3D;5.4.17</p>
<p>&lt;&#x3D;4.5.12</p>
</blockquote>
<p>前几天的6.2.6就是对这个CVE的修补。</p>
<p>我们先看看官方poc：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/@fs/Users/doggy/Desktop/vite-project/#/../../../../../etc/passwd</span><br></pre></td></tr></table></figure>

<p>也是一种目录穿越，但是跟CVE-2025-31486的又有不同之处。</p>
<p>commit如下：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/vitejs/vite/commit/175a83909f02d3b554452a7bd02b9f340cdfef70">https://github.com/vitejs/vite/commit/175a83909f02d3b554452a7bd02b9f340cdfef70</a></p>
<img src="/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/image-20250414135209030.png" class="" title="This is an example image">



<p>我们可以看到这里新增了一个方法来检测<code>#</code>，从而防止CVE-2025-32395</p>
<h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>先搭建一下漏洞版本看看</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm create vite@latest</span><br><span class="line">cd vite-project/</span><br><span class="line">npm install vite@6.2.5</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure>

<img src="/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/image-20250414140931338.png" class="" title="This is an example image">

<p>这里我发现如何直接在页面url访问是获取不到的？那么接下来我们用yakit试试</p>
<img src="/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/image-20250414141112003.png" class="" title="This is an example image">



<p>还有一种搭建方法，用webstorm</p>
<img src="/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/image-20250417124308498.png" class="" title="This is an example image">

<img src="/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/image-20250417124316812.png" class="" title="This is an example image">

<p>本次测试看看效果，当我们访问如下url时：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:5173/@fs/Users</span><br></pre></td></tr></table></figure>

<p>页面回显如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">403 Restricted</span><br><span class="line">The request url &quot;C:/Users&quot; is outside of Vite serving allow list.</span><br><span class="line"></span><br><span class="line">- C:/Users/TY/Desktop/cve/vite浠绘剰鏂囦欢璇讳竴鍫哻ve/vite6.2.5-project</span><br><span class="line"></span><br><span class="line">Refer to docs https://vite.dev/config/server-options.html#server-fs-allow for configurations and more details.</span><br></pre></td></tr></table></figure>

<p>它说<code>C:/Users is outside of Vite serving allow list</code> ，那么下面给的<code>C:/Users/TY/Desktop/cve/vite浠绘剰鏂囦欢璇讳竴鍫哻ve/vite6.2.5-project</code>应该就是<code>allow list</code>，那么我们便可能通过目录穿越实现任意文件读取。</p>
<img src="/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/image-20250417125209196.png" class="" title="This is an example image">





<h2 id="源码审计"><a href="#源码审计" class="headerlink" title="源码审计"></a>源码审计</h2><p>poc：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/@fs/Users/TY/Desktop/cve/vite%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E4%B8%80%E5%A0%86cve/vite6.2.5-project/#/../../../../../../../windows/win.ini</span><br></pre></td></tr></table></figure>

<p>我们跟一边poc！</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">viteServePublicMiddleware</span>(<span class="params">req, res, next</span>) &#123;</span><br><span class="line">  <span class="comment">// To avoid the performance impact of `existsSync` on every request, we check against an</span></span><br><span class="line">  <span class="comment">// in-memory set of known public files. This set is updated on restarts.</span></span><br><span class="line">  <span class="comment">// also skip import request and internal requests `/@fs/ /@vite-client` etc...</span></span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    (publicFiles &amp;&amp; !publicFiles.<span class="title function_">has</span>(<span class="title function_">toFilePath</span>(req.<span class="property">url</span>!))) ||</span><br><span class="line">    <span class="title function_">isImportRequest</span>(req.<span class="property">url</span>!) ||</span><br><span class="line">    <span class="title function_">isInternalRequest</span>(req.<span class="property">url</span>!) ||</span><br><span class="line">    <span class="comment">// for `/public-file.js?url` to be transformed</span></span><br><span class="line">    urlRE.<span class="title function_">test</span>(req.<span class="property">url</span>!)</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">next</span>()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">serve</span>(req, res, next)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>从 <code>viteServePublicMiddleware</code> 函数开始看吧，这是一个处理请求的中间件函数，根据请求判断接下来的函数调用，满足第一个条件会进入 <code>next()</code> 也就是调用下一个中间件进行处理</p>
<p>然后就会进入下列函数，眼熟吧，前几个cve我们都分析过这。</p>
<img src="/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/image-20250417141050661.png" class="" title="This is an example image">

<p>前面就是一些简单的判读处理，比如看是否是 GET 请求，是否以 <code>.map</code> 结尾等等，这里就不细看了。</p>
<p>后续会进入到下述if语句</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (</span><br><span class="line">        req.<span class="property">headers</span>[<span class="string">&#x27;sec-fetch-dest&#x27;</span>] === <span class="string">&#x27;script&#x27;</span> ||</span><br><span class="line">        <span class="title function_">isJSRequest</span>(url) ||</span><br><span class="line">        <span class="title function_">isImportRequest</span>(url) ||</span><br><span class="line">        <span class="title function_">isCSSRequest</span>(url) ||</span><br><span class="line">        <span class="title function_">isHTMLProxy</span>(url)</span><br><span class="line">      ) &#123;</span><br></pre></td></tr></table></figure>

<p>这里肯定都不满足会进入 else 分支直接调用下一个中间件函数处理 <code>viteServeRawFsMiddleware</code>，然后在这个中间件函数中接着调用了 <code>ensureServingAccess</code> 方法，该方法是处理 HTTP 请求的，如果文件不被允许访问，则返回 403，</p>
<img src="/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/image-20250417141751949.png" class="" title="This is an example image">

<p>然后我们关注一下下一个中间件函数处理 <code>viteServeRawFsMiddleware</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">viteServeRawFsMiddleware</span>(<span class="params">req, res, next</span>) &#123;</span><br><span class="line">  <span class="comment">// In some cases (e.g. linked monorepos) files outside of root will</span></span><br><span class="line">  <span class="comment">// reference assets that are also out of served root. In such cases</span></span><br><span class="line">  <span class="comment">// the paths are rewritten to `/@fs/` prefixed paths and must be served by</span></span><br><span class="line">  <span class="comment">// searching based from fs root.</span></span><br><span class="line">  <span class="keyword">if</span> (req.<span class="property">url</span>!.<span class="title function_">startsWith</span>(<span class="variable constant_">FS_PREFIX</span>)) &#123;</span><br><span class="line">    <span class="keyword">const</span> url = <span class="keyword">new</span> <span class="title function_">URL</span>(req.<span class="property">url</span>!, <span class="string">&#x27;http://example.com&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> pathname = <span class="built_in">decodeURI</span>(url.<span class="property">pathname</span>)</span><br><span class="line">    <span class="comment">// restrict files outside of `fs.allow`</span></span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">      !<span class="title function_">ensureServingAccess</span>(</span><br><span class="line">        <span class="title function_">slash</span>(path.<span class="title function_">resolve</span>(<span class="title function_">fsPathFromId</span>(pathname))),</span><br><span class="line">        server,</span><br><span class="line">        res,</span><br><span class="line">        next,</span><br><span class="line">      )</span><br><span class="line">    ) &#123;</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> newPathname = pathname.<span class="title function_">slice</span>(<span class="variable constant_">FS_PREFIX</span>.<span class="property">length</span>)</span><br><span class="line">    <span class="keyword">if</span> (isWindows) newPathname = newPathname.<span class="title function_">replace</span>(<span class="regexp">/^[A-Z]:/i</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    url.<span class="property">pathname</span> = <span class="built_in">encodeURI</span>(newPathname)</span><br><span class="line">    req.<span class="property">url</span> = url.<span class="property">href</span>.<span class="title function_">slice</span>(url.<span class="property">origin</span>.<span class="property">length</span>)</span><br><span class="line">    <span class="title function_">serveFromRoot</span>(req, res, next)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>本CVE就是绕过ensureServingAccess。但是在进入ensureServingAccess之前，我们发现上方存在两段代码：</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> url = <span class="keyword">new</span> <span class="title function_">URL</span>(req.<span class="property">url</span>!, <span class="string">&#x27;http://example.com&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> pathname = <span class="built_in">decodeURI</span>(url.<span class="property">pathname</span>)</span><br></pre></td></tr></table></figure>

<p>注意到这里的 new URL，其会把 <code>#</code> 后面的内容当作注释，从而返回的 url 只有 <code>/@fs/Users/TY/Desktop/cve/vite%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E4%B8%80%E5%A0%86cve/vite6.2.5-project/</code>，这其实就是我们的项目目录，也就是allowed file。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">ensureServingAccess</span>(<span class="params"></span></span><br><span class="line"><span class="params">  <span class="attr">url</span>: <span class="built_in">string</span>,</span></span><br><span class="line"><span class="params">  <span class="attr">server</span>: <span class="title class_">ViteDevServer</span>,</span></span><br><span class="line"><span class="params">  <span class="attr">res</span>: <span class="title class_">ServerResponse</span>,</span></span><br><span class="line"><span class="params">  <span class="attr">next</span>: <span class="title class_">Connect</span>.<span class="title class_">NextFunction</span>,</span></span><br><span class="line"><span class="params"></span>): <span class="built_in">boolean</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">isFileServingAllowed</span>(url, server)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">isFileReadable</span>(<span class="title function_">cleanUrl</span>(url))) &#123;</span><br><span class="line">    <span class="keyword">const</span> urlMessage = <span class="string">`The request url &quot;<span class="subst">$&#123;url&#125;</span>&quot; is outside of Vite serving allow list.`</span></span><br><span class="line">    <span class="keyword">const</span> hintMessage = <span class="string">`</span></span><br><span class="line"><span class="string"><span class="subst">$&#123;server.config.server.fs.allow.map((i) =&gt; <span class="string">`- <span class="subst">$&#123;i&#125;</span>`</span>).join(<span class="string">&#x27;\n&#x27;</span>)&#125;</span></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Refer to docs https://vite.dev/config/server-options.html#server-fs-allow for configurations and more details.`</span></span><br><span class="line"></span><br><span class="line">    server.<span class="property">config</span>.<span class="property">logger</span>.<span class="title function_">error</span>(urlMessage)</span><br><span class="line">    server.<span class="property">config</span>.<span class="property">logger</span>.<span class="title function_">warnOnce</span>(hintMessage + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    res.<span class="property">statusCode</span> = <span class="number">403</span></span><br><span class="line">    res.<span class="title function_">write</span>(<span class="title function_">renderRestrictedErrorHTML</span>(urlMessage + <span class="string">&#x27;\n&#x27;</span> + hintMessage))</span><br><span class="line">    res.<span class="title function_">end</span>()</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// if the file doesn&#x27;t exist, we shouldn&#x27;t restrict this path as it can</span></span><br><span class="line">    <span class="comment">// be an API call. Middlewares would issue a 404 if the file isn&#x27;t handled</span></span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此处会先调用isFileServingAllowed，判断url是否允许被vite服务器访问。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">isFileServingAllowed</span>(<span class="params"></span></span><br><span class="line"><span class="params">  <span class="attr">url</span>: <span class="built_in">string</span>,</span></span><br><span class="line"><span class="params">  <span class="attr">server</span>: <span class="title class_">ViteDevServer</span>,</span></span><br><span class="line"><span class="params"></span>): <span class="built_in">boolean</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">isFileServingAllowed</span>(<span class="params"></span></span><br><span class="line"><span class="params">  <span class="attr">configOrUrl</span>: <span class="title class_">ResolvedConfig</span> | <span class="built_in">string</span>,</span></span><br><span class="line"><span class="params">  <span class="attr">urlOrServer</span>: <span class="built_in">string</span> | <span class="title class_">ViteDevServer</span>,</span></span><br><span class="line"><span class="params"></span>): <span class="built_in">boolean</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> config = (</span><br><span class="line">    <span class="keyword">typeof</span> urlOrServer === <span class="string">&#x27;string&#x27;</span> ? configOrUrl : urlOrServer.<span class="property">config</span></span><br><span class="line">  ) <span class="keyword">as</span> <span class="title class_">ResolvedConfig</span></span><br><span class="line">  <span class="keyword">const</span> url = (</span><br><span class="line">    <span class="keyword">typeof</span> urlOrServer === <span class="string">&#x27;string&#x27;</span> ? urlOrServer : configOrUrl</span><br><span class="line">  ) <span class="keyword">as</span> <span class="built_in">string</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!config.<span class="property">server</span>.<span class="property">fs</span>.<span class="property">strict</span>) <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  <span class="keyword">const</span> filePath = <span class="title function_">fsPathFromUrl</span>(url)</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">isFileLoadingAllowed</span>(config, filePath)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其执行了 <code>isFileLoadingAllowed</code> 函数检查文件路径是否符合 Vite 的文件访问规则。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">isFileLoadingAllowed</span>(<span class="params"></span></span><br><span class="line"><span class="params">  <span class="attr">config</span>: <span class="title class_">ResolvedConfig</span>,</span></span><br><span class="line"><span class="params">  <span class="attr">filePath</span>: <span class="built_in">string</span>,</span></span><br><span class="line"><span class="params"></span>): <span class="built_in">boolean</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; fs &#125; = config.<span class="property">server</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!fs.<span class="property">strict</span>) <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (config.<span class="title function_">fsDenyGlob</span>(filePath)) <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (config.<span class="property">safeModulePaths</span>.<span class="title function_">has</span>(filePath)) <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (fs.<span class="property">allow</span>.<span class="title function_">some</span>(<span class="function">(<span class="params">uri</span>) =&gt;</span> <span class="title function_">isUriInFilePath</span>(uri, filePath))) <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>存在几个条件判断，只有返回 true 才能允许访问，比如看最后一个判断</p>
<p>我们跟进一下allow，此处应该就是允许的目录</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">allow</span>?: <span class="built_in">string</span>[]</span><br></pre></td></tr></table></figure>

<p>再次跟进。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="attr">server</span>: <span class="title class_">ResolvedServerOptions</span> = &#123;</span><br><span class="line">  ..._server,</span><br><span class="line">  <span class="attr">fs</span>: &#123;</span><br><span class="line">    ..._server.<span class="property">fs</span>,</span><br><span class="line">    <span class="comment">// run searchForWorkspaceRoot only if needed</span></span><br><span class="line">    <span class="attr">allow</span>: raw?.<span class="property">fs</span>?.<span class="property">allow</span> ?? [<span class="title function_">searchForWorkspaceRoot</span>(root)],</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">sourcemapIgnoreList</span>:</span><br><span class="line">    _server.<span class="property">sourcemapIgnoreList</span> === <span class="literal">false</span></span><br><span class="line">      ? <span class="function">() =&gt;</span> <span class="literal">false</span></span><br><span class="line">      : _server.<span class="property">sourcemapIgnoreList</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>searchForWorkspaceRoot</code>，看英文就是查询工作空间根目录，应该就是网站目录！</p>
<p>那么使用我们上述的poc，此处就会返回true！</p>
<p>最后绕过 <code>ensureServingAccess</code> 方法，同样也返回 true，</p>
<p>目录验证后，后续的处理逻辑却又是使用我们原始的url进行处理，最后像正常读取 <code>/@fs/</code> 允许目录下的文件一样进行读取，通过目录穿越访问到任意文件</p>
<h2 id="漏洞修补"><a href="#漏洞修补" class="headerlink" title="漏洞修补"></a>漏洞修补</h2><p>我们直接看官方commit</p>
<p><a target="_blank" rel="noopener" href="https://github.com/vitejs/vite/commit/3bb0883d22d59cfd901ff18f338e8b4bf11395f7">https://github.com/vitejs/vite/commit/3bb0883d22d59cfd901ff18f338e8b4bf11395f7</a></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (req.<span class="property">url</span>?.<span class="title function_">includes</span>(<span class="string">&#x27;#&#x27;</span>)) &#123;</span><br><span class="line">  <span class="comment">// HTTP 1.1 spec recommends sending 400 Bad Request</span></span><br><span class="line">  <span class="comment">// (https://datatracker.ietf.org/doc/html/rfc9112#section-3.2-4)</span></span><br><span class="line">  res.<span class="title function_">writeHead</span>(<span class="number">400</span>)</span><br><span class="line">  res.<span class="title function_">end</span>()</span><br><span class="line">  <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>不允许url中包含<code>#</code>，否则直接报错400.</p>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About me</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a target="_blank" rel="noopener" href="https://github.com/MeteorKai/">Projects</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a href="/categories/">categories</a></li>
        
          <li><a href="/tags/">tags</a></li>
        
          <li><a href="/links/">links</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-number">1.</span> <span class="toc-text">环境搭建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%AE%A1%E8%AE%A1"><span class="toc-number">2.</span> <span class="toc-text">源码审计</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E4%BF%AE%E8%A1%A5"><span class="toc-number">3.</span> <span class="toc-text">漏洞修补</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/&text=Vite开发服务器任意文件读取漏洞分析复现(CVE-2025-32395)"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/&title=Vite开发服务器任意文件读取漏洞分析复现(CVE-2025-32395)"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/&is_video=false&description=Vite开发服务器任意文件读取漏洞分析复现(CVE-2025-32395)"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Vite开发服务器任意文件读取漏洞分析复现(CVE-2025-32395)&body=Check out this article: http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/&title=Vite开发服务器任意文件读取漏洞分析复现(CVE-2025-32395)"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/&title=Vite开发服务器任意文件读取漏洞分析复现(CVE-2025-32395)"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/&title=Vite开发服务器任意文件读取漏洞分析复现(CVE-2025-32395)"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/&title=Vite开发服务器任意文件读取漏洞分析复现(CVE-2025-32395)"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/&name=Vite开发服务器任意文件读取漏洞分析复现(CVE-2025-32395)&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://meteorkai.github.io/2025/04/17/Vite%E5%BC%80%E5%8F%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0-CVE-2025-32395/&t=Vite开发服务器任意文件读取漏洞分析复现(CVE-2025-32395)"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        
<footer id="footer">
    <div class="footer-left">
        Copyright ©
        
        
        2024-2025
        Meteor_Kai
        <br>
        <a href="https://www.dkdun.cn/" target="_blank">DK盾</a>
    </div>
    
    <div class="footer-right">
        <nav>
            <ul>
                <!--
                --><li><a href="/">Home</a></li><!--
                --><!--
                --><li><a href="/about/">About me</a></li><!--
                --><!--
                --><li><a href="/archives/">Writing</a></li><!--
                --><!--
                --><li><a target="_blank" rel="noopener" href="https://github.com/MeteorKai/">Projects</a></li><!--
                --><!--
                --><li><a href="/search/">Search</a></li><!--
                --><!--
                --><li><a href="/categories/">categories</a></li><!--
                --><!--
                --><li><a href="/tags/">tags</a></li><!--
                --><!--
                --><li><a href="/links/">links</a></li><!--
                -->
            </ul>
            <ul>
                
                <!-- 不蒜子统计 -->
                <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
                <span class="post-meta-divider">|</span>
                <span id="busuanzi_container_site_uv" style='display:none'>本站访客数<span id="busuanzi_value_site_uv"></span>人</span>
                <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
                
            </ul>
        </nav>
    </div>
</footer>


    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'Meteor_Kai';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>

<!-- utterances Comments -->

</body>
</html>
